<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>KuppyCloaker</title>
<style>
:root {
  --bg: #0f1724;
  --card: #0b1220;
  --muted: #93a3b8;
  --accent: #007bff;
  --text: #e6eef8;
}
* {
  transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;
}

#homePage {
  display: none;
}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  min-height: 100%;
  overflow: hidden;
}

body {
  font-family: Inter, system-ui, sans-serif;
  background-color: var(--bg);
  color: var(--text);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  padding: 20px;
  gap: 16px;
  transition: background-color 0.5s, color 0.5s, opacity 2s ease;
  opacity: 0;
  overflow-y: auto;
  position: relative;
}
body.loaded { opacity: 1; }

#particleCanvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
  opacity: 0.6;
}

body::before {
  content: '';
  position: fixed;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle at 20% 50%, rgba(0, 123, 255, 0.03) 0%, transparent 50%),
              radial-gradient(circle at 80% 80%, rgba(147, 51, 234, 0.03) 0%, transparent 50%),
              radial-gradient(circle at 40% 20%, rgba(59, 130, 246, 0.02) 0%, transparent 50%);
  animation: ambientMove 20s ease-in-out infinite;
  z-index: 0;
  pointer-events: none;
}

@keyframes ambientMove {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  33% { transform: translate(3%, 3%) rotate(2deg); }
  66% { transform: translate(-2%, 4%) rotate(-1deg); }
}

.shell {
  background: var(--card);
  border-radius: 14px;
  padding: 22px 30px;
  box-shadow: 0 10px 30px rgba(2,6,23,0.6);
  position: relative;
  width: 100%;
  max-width: 800px;
  animation: fadeInScale 0.6s ease-out;
  z-index: 1;
}
header { display: flex; align-items: center; justify-content: space-between; }

.gear {
  cursor: pointer;
  font-size: 24px;
  color: var(--accent);
  transition: transform 0.4s ease, color 0.3s ease;
  display: inline-block;
}

.gear:hover {
  transform: rotate(90deg) scale(1.1);
  color: var(--text);
}

.gear.spin {
  animation: spinOnce 0.5s ease;
}

@keyframes spinOnce {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

#settingsMenu {
  position: absolute;
  top: 36px;
  right: 36px;
  background: var(--card);
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: 10px;
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.4);
  opacity: 0;
  transform: translateY(-10px) scale(0.95);
  pointer-events: none;
  transition: opacity 0.35s ease, transform 0.35s ease;
  z-index: 9999;
}

#settingsMenu.show {
  opacity: 1;
  transform: translateY(0) scale(1);
  pointer-events: auto;
}

#settingsMenu.show button {
  animation: slideIn 0.25s ease forwards;
}

@keyframes slideIn {
  from { transform: translateX(10px); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

#settingsMenu button {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 20px;
  cursor: pointer;
  transition: color 0.2s, transform 0.2s;
}

#settingsMenu button:hover {
  color: var(--accent);
  transform: scale(1.1);
}

#typedTitle::after {
  content: "|";
  display: inline-block;
  margin-left: 4px;
  animation: blink 1s step-start 5, hideCursor 0s 4s forwards;
  color: var(--accent);
}

#typedTitle {
  text-align: center;
  width: 185%;
}

#settingsIcon {
  position: absolute;
  top: 20px;
  right: 25px;
  font-size: 22px;
  color: var(--accent, #007bff);
  cursor: pointer;
  transition: transform 0.3s ease, color 0.3s ease;
}

#settingsIcon:hover {
  animation: spin 1s linear infinite;
  color: var(--text, #fff);
}

@keyframes blink { 50% { opacity: 0; } }

@keyframes hideCursor { to { opacity: 0; } }

@keyframes slideInFromTop {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInFromBottom {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeInScale {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes slideInFromLeft {
  from {
    opacity: 0;
    transform: translateX(-30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInFromRight {
  from {
    opacity: 0;
    transform: translateX(30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes gentlePulse {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.02);
  }
}

@keyframes weatherIconFloat {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-5px);
  }
}

.topbar { 
  display: flex; 
  margin-top: 16px; 
  gap: 10px;
  animation: slideInFromTop 0.6s ease-out 0.2s both;
}
input {
  flex: 1;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.1);
  background: var(--bg);
  color: var(--text);
  transition: border-color 0.3s, box-shadow 0.3s, transform 0.2s;
}

input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
  transform: translateY(-1px);
}

.btn {
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 10px;
  padding: 10px 16px;
  cursor: pointer;
  font-weight: 600;
  transition: transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s;
  position: relative;
  overflow: hidden;
}

.btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

.btn:active::before {
  width: 300px;
  height: 300px;
}

.btn:active {
  transform: scale(0.92);
}

.btn:hover { 
  opacity: 0.9;
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 4px 12px rgba(0, 123, 255, 0.4);
}

footer {
  margin-top: 20px;
  color: var(--muted);
  position: relative;
  z-index: 1;
}

.card {
  background: rgba(255,255,255,0.05);
  border-radius: 8px;
  padding: 8px;
  cursor: pointer;
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s;
  text-align: center;
  position: relative;
  box-sizing: border-box;
  width: 135px;
  min-width: 100px;
  max-width: 155px;
  aspect-ratio: 1 / 1;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  transform-style: preserve-3d;
  perspective: 1000px;
}

.card span {
  pointer-events: none;
  font-weight: 600;
  text-shadow: 0 0 4px var(--accent), 0 0 5px rgba(0, 123, 255, 0.1);
}

.card img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: inherit;
  display: block;
  background: transparent;
  transition: transform 0.3s ease;
}

.card:hover img {
  transform: scale(1.05);
}

.card-title {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.6));
  opacity: 0;
  transform: translateY(8px);
  transition: opacity 180ms ease, transform 200ms cubic-bezier(.2,.9,.3,1);
  font-weight: 800;
  text-align: center;
  padding: 8px;
  pointer-events: none;
  z-index: 2;
}

.card:hover .card-title { 
  opacity: 1; 
  transform: translateY(0);
}

.starBtn, .deleteBtn { z-index: 4; }

.card:hover { 
  transform: translateY(-8px) scale(1.05); 
  box-shadow: 0 18px 40px rgba(0,0,0,0.45), 0 0 26px rgba(0,0,0,0.15) inset; 
}

.starBtn.starred {
  animation: starPop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes starPop {
  0% { transform: scale(1); }
  50% { transform: scale(1.4) rotate(15deg); }
  100% { transform: scale(1) rotate(0deg); }
}

.card::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  padding: 2px;
  pointer-events: none;
  z-index: 0;
  box-shadow: 0 0 0 1px rgba(255,255,255,0.02) inset;
  transition: box-shadow 260ms ease, transform 260ms ease, opacity 260ms ease;
  opacity: 0.95;
}

.card:hover::before { 
  box-shadow: 0 0 30px var(--accent), 0 0 8px rgba(0,0,0,0.25) inset; 
  transform: scale(1.01); 
  opacity: 1; 
}

@keyframes floatSlow { 0% { transform: translateY(0); } 50% { transform: translateY(-4px); } 100% { transform: translateY(0); } }

@keyframes pulseAccent { 0% { box-shadow: 0 0 0 rgba(0,0,0,0); } 50% { box-shadow: 0 0 18px rgba(0,123,255,0.12); } 100% { box-shadow: 0 0 0 rgba(0,0,0,0); } }

.starBtn {
  position: absolute;
  top: 8px;
  right: 8px;
  font-size: 18px;
  background: none;
  border: none;
  cursor: pointer;
  color: var(--muted);
  transition: transform 0.2s, color 0.2s;
}

.starBtn:hover {
  transform: scale(1.2);
}

.fade {
  transition: opacity 0.5s ease;
}

.hidden {
  opacity: 0;
  pointer-events: none;
}

.forms-icon img {
  width: 20px;
  height: 20px;
  vertical-align: middle;
  margin-left: 8px;
  transition: transform 0.25s ease, filter 0.25s ease;
}

.starBtn.starred { 
  color: gold;
  filter: drop-shadow(0 0 8px gold);
}

.deleteBtn {
  position: absolute;
  bottom: 8px;
  right: 8px;
  font-size: 16px;
  background: none;
  border: none;
  cursor: pointer;
  color: var(--muted);
  transition: transform 0.2s, color 0.2s;
}

.deleteBtn:hover { 
  color: red; 
  transform: scale(1.2);
}

.presets-grid {
  margin-top: 20px;
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
  justify-items: center;
}

.skeleton {
  background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
  border-radius: 8px;
}

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

#gamesPage, #multigamesPage, #puzzlegamesPage, #obbygamesPage, #sportsgamesPage {
  display: none;
  flex-direction: column;
  align-items: center;
  opacity: 0;
  transform: translateX(100%);
  transition: opacity 0.5s, transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  overflow-y: auto;
  overflow-x: hidden;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  padding-bottom: 40px;
  z-index: 1;
}

#gamesPage.show, #multigamesPage.show, 
#puzzlegamesPage.show, #obbygamesPage.show, #sportsgamesPage.show {
  display: flex;
  opacity: 1;
  transform: translateX(0);
}

.multiplayer-grid, .puzzle-grid, .obby-grid, .sports-grid {
  margin-top: 20px;
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
  justify-items: center;
}

.info-shell {
  background: var(--card);
  border-radius: 12px;
  padding: 16px 24px;
  box-shadow: 0 8px 20px rgba(2,6,23,0.5);
  display: flex;
  align-items: center;
  gap: 32px;
  border: 1px solid rgba(255,255,255,0.05);
  width: 100%;
  max-width: 800px;
  animation: fadeInScale 0.6s ease-out;
  z-index: 1;
  position: relative;
}

.time-section {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 140px;
  animation: slideInFromLeft 0.6s ease-out;
}

.time-display {
  font-size: 32px;
  font-weight: 700;
  color: var(--text);
  letter-spacing: -0.5px;
  line-height: 1;
}

.date-display {
  font-size: 13px;
  color: var(--muted);
  font-weight: 500;
}

.divider {
  width: 1px;
  height: 50px;
  background: rgba(255,255,255,0.1);
}

.weather-section {
  display: flex;
  align-items: center;
  gap: 16px;
  flex: 1;
  animation: slideInFromRight 0.6s ease-out 0.1s both;
}

.weather-icon {
  font-size: 40px;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  animation: weatherIconFloat 3s ease-in-out infinite;
  position: relative;
}

.weather-icon.rainy::after {
  content: 'üíß';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  font-size: 16px;
  animation: rainDrop 1s infinite;
}

@keyframes rainDrop {
  0% { opacity: 1; transform: translateX(-50%) translateY(0); }
  100% { opacity: 0; transform: translateX(-50%) translateY(20px); }
}

.weather-icon.sunny {
  animation: weatherIconFloat 3s ease-in-out infinite, sunRotate 8s linear infinite;
}

@keyframes sunRotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.weather-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.temperature {
  font-size: 28px;
  font-weight: 700;
  color: var(--text);
  line-height: 1;
}

.weather-desc {
  font-size: 13px;
  color: var(--muted);
  text-transform: capitalize;
  font-weight: 500;
}

.weather-details {
  display: flex;
  gap: 16px;
  margin-left: auto;
  font-size: 12px;
  color: var(--muted);
}

.weather-detail {
  display: flex;
  flex-direction: column;
  gap: 2px;
  text-align: center;
}

.detail-label {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  opacity: 0.7;
}

.detail-value {
  font-weight: 600;
  color: var(--text);
  font-size: 13px;
}

.starred-games-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}

.starred-game-icon {
  position: absolute;
  width: 90px;
  height: 90px;
  pointer-events: auto;
  cursor: grab;
  transition: box-shadow 0.2s, transform 0.2s;
  border-radius: 12px;
  overflow: hidden;
  background: var(--card);
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  user-select: none;
  animation: fadeInScale 0.5s ease-out backwards;
}

.starred-game-icon.dragging {
  cursor: grabbing;
  opacity: 0.8;
  z-index: 1000;
  transition: none;
}

.starred-game-icon:hover:not(.dragging) {
  transform: scale(1.1);
  box-shadow: 0 8px 20px rgba(0,0,0,0.5), 0 0 20px var(--accent);
}

.starred-game-icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: inherit;
}

#fadeOverlay {
  position: fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:black;
  opacity:0;
  pointer-events:none;
  transition:opacity 0.5s;
  z-index:9999;
}

#fadeOverlay.active { 
  opacity:1; 
  pointer-events:auto; 
}

.toast {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: var(--card);
  color: var(--text);
  padding: 12px 20px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  gap: 10px;
  z-index: 10000;
  animation: toastSlideIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  border-left: 4px solid var(--accent);
}

@keyframes toastSlideIn {
  from {
    opacity: 0;
    transform: translateX(100px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.toast.success {
  border-left-color: #10b981;
}

.toast.error {
  border-left-color: #ef4444;
}

body.weather-rain::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(transparent 0%, rgba(30, 58, 138, 0.1) 100%);
  pointer-events: none;
  z-index: 0;
}

body.weather-snow::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(transparent 0%, rgba(219, 234, 254, 0.1) 100%);
  pointer-events: none;
  z-index: 0;
}

body.weather-sunny::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: radial-gradient(circle at 70% 30%, rgba(251, 191, 36, 0.05) 0%, transparent 50%);
  pointer-events: none;
  z-index: 0;
}

.confetti {
  position: fixed;
  width: 10px;
  height: 10px;
  pointer-events: none;
  z-index: 10000;
  animation: confettiFall 3s ease-out forwards;
}

@keyframes confettiFall {
  0% {
    transform: translateY(0) rotateZ(0deg);
    opacity: 1;
  }
  100% {
    transform: translateY(100vh) rotateZ(720deg);
    opacity: 0;
  }
}

.achievement {
  position: fixed;
  top: 80px;
  right: -400px;
  background: linear-gradient(135deg, var(--card) 0%, rgba(0, 123, 255, 0.2) 100%);
  padding: 16px 24px;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
  display: flex;
  align-items: center;
  gap: 16px;
  border-left: 4px solid gold;
  z-index: 10001;
  animation: achievementSlide 4s cubic-bezier(0.34, 1.56, 0.64, 1);
  max-width: 350px;
}

@keyframes achievementSlide {
  0% { right: -400px; }
  15% { right: 20px; }
  85% { right: 20px; }
  100% { right: -400px; }
}

.achievement-icon {
  font-size: 48px;
  animation: achievementPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes achievementPop {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.3) rotate(10deg); }
}

.achievement-content h3 {
  margin: 0;
  color: gold;
  font-size: 16px;
  text-shadow: 0 0 10px gold;
}

.achievement-content p {
  margin: 4px 0 0 0;
  color: var(--muted);
  font-size: 13px;
}

#comboCounter {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  font-size: 72px;
  font-weight: 900;
  color: var(--accent);
  text-shadow: 0 0 20px var(--accent), 0 0 40px var(--accent);
  z-index: 10002;
  pointer-events: none;
  opacity: 0;
}

#comboCounter.show {
  animation: comboAppear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes comboAppear {
  0% {
    transform: translate(-50%, -50%) scale(0) rotate(-10deg);
    opacity: 0;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.2) rotate(5deg);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scale(1) rotate(0deg);
    opacity: 1;
  }
}

body.shake {
  animation: screenShake 0.5s ease-in-out;
}

@keyframes screenShake {
  0%, 100% { transform: translate(0, 0); }
  10% { transform: translate(-5px, 2px); }
  20% { transform: translate(5px, -2px); }
  30% { transform: translate(-5px, -2px); }
  40% { transform: translate(5px, 2px); }
  50% { transform: translate(-5px, 2px); }
  60% { transform: translate(5px, -2px); }
  70% { transform: translate(-5px, -2px); }
  80% { transform: translate(5px, 2px); }
  90% { transform: translate(-5px, -2px); }
}

.breathe {
  animation: breathe 3s ease-in-out infinite;
}

@keyframes breathe {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.02); opacity: 0.9; }
}

.card.flipping {
  animation: cardFlip 0.6s ease-in-out;
}

@keyframes cardFlip {
  0% { transform: rotateY(0deg) scale(1); }
  50% { transform: rotateY(90deg) scale(0.9); }
  100% { transform: rotateY(0deg) scale(1); }
}

#fab {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--accent) 0%, #0056b3 100%);
  color: white;
  font-size: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
  z-index: 1000;
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s;
  animation: fabPulse 2s ease-in-out infinite;
}

@keyframes fabPulse {
  0%, 100% { box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4); }
  50% { box-shadow: 0 6px 30px rgba(0, 123, 255, 0.8); }
}

#fab:hover {
  transform: scale(1.1) rotate(90deg);
}

#fabMenu {
  position: fixed;
  bottom: 110px;
  right: 20px;
  background: var(--card);
  border-radius: 12px;
  padding: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.3);
  display: flex;
  flex-direction: column;
  gap: 8px;
  opacity: 0;
  transform: scale(0.8) translateY(20px);
  pointer-events: none;
  transition: opacity 0.3s, transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  z-index: 999;
}

#fabMenu.show {
  opacity: 1;
  transform: scale(1) translateY(0);
  pointer-events: auto;
}

.fab-item {
  padding: 10px 16px;
  border-radius: 8px;
  background: rgba(255,255,255,0.05);
  color: var(--text);
  cursor: pointer;
  transition: background 0.2s, transform 0.2s;
  white-space: nowrap;
  font-size: 14px;
}

.fab-item:hover {
  background: var(--accent);
  transform: translateX(-5px);
}

#statsPanel {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.8);
  background: var(--card);
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
  z-index: 10004;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s, transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  min-width: 350px;
  max-width: 90vw;
  max-height: 85vh;
  overflow-y: auto;
  border: 1px solid rgba(255,255,255,0.1);
  cursor: default;
}

#statsPanel.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
  pointer-events: auto;
}

#statsPanel h2 {
  margin: 0 0 20px 0;
  color: var(--accent);
  text-align: center;
}

.stat-row {
  display: flex;
  justify-content: space-between;
  padding: 12px 0;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}

.stat-label {
  color: var(--muted);
}

.stat-value {
  color: var(--accent);
  font-weight: 700;
}

#statsClose {
  position: absolute;
  top: 16px;
  right: 16px;
  background: none;
  border: none;
  color: var(--muted);
  font-size: 24px;
  cursor: pointer;
  transition: color 0.2s, transform 0.2s;
}

#statsClose:hover {
  color: var(--accent);
  transform: rotate(90deg);
}

#welcomeOverlay {
  position: fixed;
  inset: 0;
  background: var(--bg);
  z-index: 10005;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  gap: 20px;
  opacity: 1;
  transition: opacity 1s ease;
}

#welcomeOverlay.hide {
  opacity: 0;
  pointer-events: none;
}

#welcomeText {
  font-size: 64px;
  font-weight: 900;
  background: linear-gradient(90deg, var(--accent), #9333ea, var(--accent));
  background-size: 200% 100%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: welcomeGradient 3s ease infinite, welcomeScale 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes welcomeGradient {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes welcomeScale {
  0% { transform: scale(0) rotate(-10deg); opacity: 0; }
  100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

#welcomeSubtext {
  color: var(--muted);
  font-size: 18px;
  animation: fadeInUp 1s ease 0.5s both;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.matrix-char {
  position: fixed;
  color: #00ff00;
  font-family: monospace;
  font-size: 16px;
  pointer-events: none;
  z-index: 0;
  text-shadow: 0 0 5px #00ff00;
  animation: matrixFall linear forwards;
}

@keyframes matrixFall {
  to {
    transform: translateY(100vh);
    opacity: 0;
  }
}

.easter-egg-found {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 120px;
  z-index: 10006;
  pointer-events: none;
  animation: easterEggReveal 2s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes easterEggReveal {
  0% {
    transform: translate(-50%, -50%) scale(0) rotate(-180deg);
    opacity: 0;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.5) rotate(10deg);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scale(0) rotate(180deg);
    opacity: 0;
  }
}

.progress-bar {
  position: fixed;
  top: 0;
  left: 0;
  width: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--accent), #9333ea);
  z-index: 10007;
  transition: width 0.3s ease;
  box-shadow: 0 0 10px var(--accent);
}

.badge {
  display: inline-block;
  width: 40px;
  height: 40px;
  margin: 5px;
  border-radius: 50%;
  background: linear-gradient(135deg, gold, #ff8c00);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
  animation: badgeShine 2s ease-in-out infinite;
  position: relative;
}

@keyframes badgeShine {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.3); }
}

.badge.locked {
  background: rgba(255,255,255,0.1);
  filter: grayscale(1);
  opacity: 0.3;
}

.badge::after {
  content: '';
  position: absolute;
  inset: -5px;
  border-radius: 50%;
  border: 2px solid transparent;
  animation: badgeRing 2s ease-in-out infinite;
}

@keyframes badgeRing {
  0%, 100% { 
    border-color: transparent;
    transform: scale(1);
  }
  50% { 
    border-color: gold;
    transform: scale(1.2);
  }
}
</style>
</head>
<body>
<canvas id="particleCanvas"></canvas>

<div id="comboCounter">x0</div>

<div id="fab">‚ö°</div>
<div id="fabMenu">
  <div class="fab-item" id="fabStats">üìä Stats</div>
  <div class="fab-item" id="lightToggle">üí° Light</div>
  <div class="fab-item" id="colorToggle">üé® Theme</div>
        <input type="file" id="bgUpload" accept="image/*" style="display:none;"> 
  <div class="fab-item" id="bgButton">üñºÔ∏è Background</div>  
  <div class="fab-item" id="passwordUnlock">üîí Weekly Password</div>
</div>

<div id="statsPanel">
  <button id="statsClose">√ó</button>
  <h2>üìä Your Stats</h2>
  <div class="stat-row">
    <span class="stat-label">Games Launched</span>
    <span class="stat-value" id="statLaunches">0</span>
  </div>
  <div class="stat-row">
    <span class="stat-label">Favorites</span>
    <span class="stat-value" id="statFavorites">0</span>
  </div>
  <div class="stat-row">
    <span class="stat-label">Total Playtime</span>
    <span class="stat-value" id="statPlaytime">0m</span>
  </div>
  <div class="stat-row">
    <span class="stat-label">Most Played</span>
    <span class="stat-value" id="statMostPlayed">None</span>
  </div>
  <div class="stat-row">
    <span class="stat-label">Badges Earned</span>
    <span class="stat-value" id="statBadges">0/10</span>
  </div>
  <div style="margin-top: 20px;">
    <h3 style="color: var(--accent); font-size: 16px; margin-bottom: 10px;">üèÜ Badges</h3>
    <div id="badgeDisplay"></div>
  </div>
</div>

<div id="welcomeOverlay">
  <div id="welcomeText">KuppyCloaker</div>
  <div id="welcomeSubtext"></div>
  <div class="progress-bar" style="position: relative; width: 300px; height: 3px; background: rgba(255,255,255,0.1); border-radius: 2px; margin-top: 20px;">
    <div id="welcomeProgress" class="progress-bar" style="position: absolute;"></div>
  </div>
</div>
<div class="shell" id="loginShell" style="display:flex; justify-content:center; align-items:center; height:100vh;">

  <div class="login-card" style="background:var(--card); padding:30px; border-radius:16px; box-shadow:0 0 20px rgba(0,0,0,0.5); width:320px; text-align:center;">
    <h1 style="color:var(--accent); margin-bottom:5px;">KuppyCloaker</h1>
    <p id="loginMsg" style="color:red; font-size:12px; height:16px;"></p>
    
<div style="width: 80%; margin: 0 auto 10px auto; box-sizing: border-box;">
  <input id="loginUsername" type="text" placeholder="Username"
         style="width: 100%; padding:10px; margin-bottom:5px; border-radius:8px; border:none; outline:none; font-family: Inter, system-ui, sans-serif; box-sizing: border-box;" />
</div>

<div style="width: 80%; margin: 0 auto 20px auto; position: relative; box-sizing: border-box;">
  <input id="loginPassword" type="password" placeholder="Password"
         style="width: 100%; padding:10px 40px 10px 10px; border-radius:8px; border:none; outline:none; font-family: Inter, system-ui, sans-serif; box-sizing: border-box;" />
  <span id="togglePassword" style="position:absolute; right:10px; top:50%; transform:translateY(-50%); cursor:pointer; user-select:none; color:var(--muted); font-size:16px;">üëÅÔ∏è</span>
</div>
</div>
</div>
<div class="starred-games-container" id="starredGamesContainer"></div>
<div class="info-shell" id="infoShell" style="display:none; margin-bottom:50px;">
  <div class="time-section">
    <div class="time-display" id="timeDisplay">--:--</div>
    <div class="date-display" id="dateDisplay">Loading...</div>
  </div>
  
  <div class="divider"></div>
  
  <div class="weather-section">
    <div class="weather-icon" id="weatherIcon">üå§Ô∏è</div>
    <div class="weather-info">
      <div class="temperature" id="temperature">--¬∞</div>
      <div class="weather-desc" id="weatherDesc">Loading weather...</div>
    </div>
    <div class="weather-details">
      <div class="weather-detail">
        <div class="detail-label">Feels</div>
        <div class="detail-value" id="feelsLike">--¬∞</div>
      </div>
      <div class="weather-detail">
        <div class="detail-label">Humid</div>
        <div class="detail-value" id="humidity">--%</div>
      </div>
      <div class="weather-detail">
        <div class="detail-label">Wind</div>
        <div class="detail-value" id="windSpeed">-- mph</div>
      </div>
    </div>
  </div>
</div>
<div class="shell" id="homePage">
<header style="position: relative;">
  <div id="userDisplay" style="position:absolute; top:12px; left:12px; color:var(--accent); font-weight:bold; text-shadow: 0 0 6px var(--accent); font-size:18px;"></div>
  <div style="display: flex; flex-direction: column; align-items: center; width: 100%;">
    <h1 id="typedTitle" style="color:white;"></h1>
    <p style="color:var(--muted); font-size:14px; text-align:center;">
      Lightweight, seamless cloaker. Paste a URL or click a button to start playing instantly.
    </p>
  </div>
    <div style="position:absolute;top:12px;right:12px;">
      <div id="settingsMenu">
      </div>
    </div>
  </header>

  <div class="topbar">
    <input id="websiteInput" type="text" placeholder="Enter a game URL" />
  </div>

<div style="display:flex; flex-direction:column; align-items:center; width:100%; gap:10px; margin-top:20px; margin-bottom:10px;">

<div style="display:flex; justify-content:center; gap:10px; margin-bottom:10px; animation: slideInFromBottom 0.6s ease-out 0.4s both;">
    <button class="btn" id="sportsGamesBtn">‚öΩ Sports</button>    
    <button class="btn" id="multiGamesBtn">üßë‚Äçü§ù‚Äçüßë Multiplayer</button>
    <button class="btn" id="puzzleGamesBtn">üß© Puzzle</button>    
    <button class="btn" id="obbyGamesBtn">üèÉ Obby</button>
  </div>

<div style="display:flex; justify-content:center; gap:10px; animation: slideInFromBottom 0.6s ease-out 0.5s both;">    <button class="btn" id="allGamesBtn">üéÆ All Games</button>    
    <button class="btn" id="recentGamesBtn">üïì Recent</button>
    <button class="btn" id="dailyGameBtn">üìÖ Daily Game</button>
    <button class="btn" id="randomGameBtn">üé≤ Random Game</button>
  </div>

</div>

  <div id="homeTab" class="tabContent" style="margin-top:20px;">
    
<div style="text-align:center; margin-top:10px;">
</div>
  </div>

<footer>
  <div>
    <div style="display:flex; align-items:center; gap:6px;">
      <span>‚Äî Kuppy</span>
      </a>
      <a href="https://docs.google.com/forms/d/e/1FAIpQLSfJDMVpKyTUI2vJoUUcEjCRgWS39s8Yai-5KmWawSi15l0r8Q/viewform?usp=header" 
         target="_blank" 
         title="Send Feedback">
        <img src="https://www.gstatic.com/images/branding/product/1x/forms_2020q4_48dp.png" 
             alt="Forms" 
             style="width:24px; height:24px; vertical-align:middle; border:none;"/>
      </a>
    </div>
  </div>
</footer></div>

<div id="gamesPage">
  <h2>All Games</h2>
  <div class="presets-grid" id="allGamesGrid"></div>
  <button id="backBtn" class="btn" style="margin-top:20px;">‚¨Ö Back</button>
</div>

<div id="multigamesPage">
  <h2>Multiplayer Games</h2>
  <div class="multiplayer-grid" id="multiGamesGrid"></div>
  <button id="multiBackBtn" class="btn" style="margin-top:20px;">‚¨Ö Back</button>
</div>

<div id="puzzlegamesPage">
  <h2>Puzzle Games</h2>
  <div class="puzzle-grid" id="puzzleGamesGrid"></div>
  <button id="puzzleBackBtn" class="btn" style="margin-top:20px;">‚¨Ö Back</button>
</div>

<div id="obbygamesPage">
  <h2>Obby Games</h2>
  <div class="obby-grid" id="obbyGamesGrid"></div>
  <button id="obbyBackBtn" class="btn" style="margin-top:20px;">‚¨Ö Back</button>
</div>

<div id="sportsgamesPage">
  <h2>Sports Games</h2>
  <div class="sports-grid" id="sportsGamesGrid"></div>
  <button id="sportsBackBtn" class="btn" style="margin-top:20px;">‚¨Ö Back</button>
</div>

<div id="fadeOverlay"></div>

<script>
const defaultGames = [
  {name: "2048", url: "https://script.google.com/macros/s/AKfycbwgo9fzGlgbzqpBKfXrw7gGGvg8cYPPL-ycgd_y9jKePSDVnk_zr_keYn8v-0eUJQd5/exec", img: "https://upload.wikimedia.org/wikipedia/commons/1/1a/2048_Icon.png"},
  {name: "Adventure Capitalist", url: "https://gavintheman.vercel.app/semag/adventure-capitalist/index.html", img: "https://www.andyroid.net/wp-content/uploads/2015/06/AdVenture-Capitalist-icon.png"},
  {name: "Backyard Baseball", url: "https://script.google.com/macros/s/AKfycbxCGoMs4wmjd_c08SeWaKuJKh9BoQlovbZIbPtzK03OLOQ6CmmImR9s6HpsxCtaHYbi/exec", img: "https://play-lh.googleusercontent.com/DwEQoD1zm9FLxRstBtdWZUXNxgyWgSsOjM0ILPtlAm1L1X7f2RZdmrjizTlOAdoDF_8=w240-h480-rw"},
  {name: "Backyard Basketball", url: "https://script.google.com/macros/s/AKfycbzutG_IKsHOQPExLK1OU1gKUy0FzeES71P13XgouwmJWvJaDi8U26ivFGRD_IHuFIDJ/exec", img: "https://play-lh.googleusercontent.com/xDCBTMTXfhB6HKHVHZXOq06e3c_7d2Ehrdqh62IcCojuX5cAMaO2wIU9tX-J-HZjtT0"},
  {name: "Baldi's Basics", url: "https://stigmabeanyay.netlify.app/games/baldisbasics/", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/baldis.webp"},
  {name: "Basket Random", url: "https://maddox05.github.io/basic-ruffle-player/html/basket_random/index.html", img: "https://play-lh.googleusercontent.com/gP8T5Z1O-ngxIloiwcBZzrzyLPYDp0R_1BDNKUDZboIRPVImeyWI8-7aExvB9gAGNKc"},
  {name: "Basketball Stars", url: "https://script.google.com/macros/s/AKfycbwzYMDDcdDUAvEP7iO6OdRk-5_oUp6vYvDdyEEz8tTOzWi5y4-Qf3vQ6TBoZuc9UYVcLg/exec", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/basketball-stars.webp"},
  {name: "BitLife", url: "https://stigmabeanyay.netlify.app/games/bitlife/", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/bitlife.webp"},
  {name: "Block Blast", url: "https://maddox05.github.io/basic-ruffle-player/html/blocky_puzzle/index.html", img: "https://play-lh.googleusercontent.com/mBpKOJBdmZLHFEfIMT0s27O-jX4MyAXqX-vhugHlTE0FKj188WmFCRElxY-inKX1tMA"},
  {name: "Bloxors", url: "https://maddox05.github.io/basic-ruffle-player/html/bloxorz/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/bloxorz.webp"},
  {name: "Boxing Random", url: "https://element-games-v5.vercel.app/g/source/boxing-random/index.html", img: "https://play-lh.googleusercontent.com/ZuMoNX6xiIBRwdtSL-FN0xCdXyahk8SRaPZ5_4HzkdQEp2Tm_GAsha9OcsRoSDgSw8Y=w240-h480-rw"},
  {name: "Clash Royale", url: "https://maddox05.github.io/basic-ruffle-player/html/clash_royale/index.html", img: "https://play-lh.googleusercontent.com/gnSC6s8-6Tjc4uhvDW7nfrSJxpbhllzYhgX8y374N1LYvWBStn2YhozS9XXaz1T_Pi2q"},
  {name: "Cookie Clicker", url: "https://stigmabeanyay.netlify.app/games/cookieclicker/", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/cookieclicker.webp"},
  {name: "Tag", url: "https://script.google.com/macros/s/AKfycby2Crs4kcY3H8tDRHQp1JRJNd_v8_zYBjwU-qF2trfXQWAeWpW1vFVzGgQdv-Ejmq6P/exec", img: "https://math711.github.io/img/class-633.png"},
  {name: "Crossy Road", url: "https://stigmabeanyay.netlify.app/games/crossy/", img: "https://math711.github.io/img/class-402.png"},
  {name: "Crazy Cattle 3D", url: "https://crazycattle.club/", img: "https://img02.symbaloo.com/XPUEyvCMeHSBnj1zo3b3Dw6a9YE=/0x7:245x252/fit-in/522x342/filters:no_upscale()/smarkImages%2Fv1%2Fd1%2Fd5%2F1cbad2544788a399975998b6a3afd8fbb336704132e64cd00edee0355012.png"},
  {name: "Doodle Jump", url: "https://raw.githack.com/skoolgq/Polaris-Assets/main/doodle-jump/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/doodle.webp"},
  {name: "Draw The Hill", url: "https://element-games-v5.vercel.app/g/source/draw-the-hill/index.html", img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTK8WYV2uyGpWXy2lKdzlsSWfdTCK9LcDs1ZQ&s"},
  {name: "Drift Boss", url: "https://script.google.com/macros/s/AKfycbwAOi2tPbjzeWDkigfZMIPEGubYxz2la_qjxJyydNZyjwgbqsv9mv05g7tdmLHdvdaw/exec", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/driftboss.webp"},
  {name: "Save My Pet", url: "https://script.google.com/macros/s/AKfycbzzzBlqpi-UH1EolZkm_TwyvFbgdV6fuWz_IjtPNgQ8ZhiPtGODuz0NvWvNlMUVWoeS/exec", img: "https://play-lh.googleusercontent.com/GmjNSIdVoTumy_mps_Ia5U7rpIcaYh_ixhWZlLCcLKCRNOOKop3fFF2fOtEHcNfrthIa"},
  {name: "Drive Mad", url: "https://gavintheman.vercel.app/semag/drivemad/index.html", img: "https://play-lh.googleusercontent.com/V_egAxch0phxs10H_Z1QpWRrsH4phd8egT_5ZjYlFbXzXvwpUGpmJMn2h6HgbGkSlZSM"},
  {name: "Fireboy & Watergirl", url: "https://rawcdn.githack.com/lioxryt/lioxryt-assets/d16b2cb691af033a5f3da3a496cb691c81977fc9/other/fbwg1/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/fireboy.webp"},
  {name: "Flappy Bird", url: "https://maddox05.github.io/basic-ruffle-player/html/flappy_bird/index.html", img: "https://upload.wikimedia.org/wikipedia/en/thumb/0/0a/Flappy_Bird_icon.png/250px-Flappy_Bird_icon.png"},
  {name: "Fruit Ninja", url: "https://bi66ie619.github.io/g/fruit-ninja.html", img: "https://math711.github.io/img/class-22.png"},
  {name: "Tomb Of The Mask", url: "https://a7k9-lq2d-v8r1-zx0c-mb6p-tn4g-wy3e-ju5h.github.io/AgicFiles183294-4/tomb/", img: "https://play-lh.googleusercontent.com/ATGr-U4JBK2VjFzKGK9eMMkrDxJaazadOUoz_7Yl0U5NrWSFcFUzEtNurWXYzVWc8uOO=w240-h480-rw"},
  {name: "Idle Mining Empire", url: "https://ubgwtf.gitlab.io/idle-mining-empire/", img: "https://unblocked-games.s3.amazonaws.com/media/posts/372/idle-mining-empire-512.jpg"},
  {name: "Geometry Dash", url: "https://gavintheman.vercel.app/semag/gdlite/index.html", img: "https://math711.github.io/img/class-453.png"},
  {name: "Getaway Shootout", url: "https://script.google.com/macros/s/AKfycbzsriooEqdtLu3zcG2AUjtLNeqgETUcTv5duzFgEKlIZAZZsYlq49sR2aN6nSwsAjcs/exec", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/rooftop.webp"},
  {name: "Helix Jump", url: "https://gavintheman.vercel.app/semag/helixjump/index.html", img: "https://play-lh.googleusercontent.com/e4Oq0lcZMGkoCTzl-J5HCahIED_9Q-nbBrMQ80MT3uEBf0gwDOh4EMEtkmdCr2Zsng"},
  {name: "Infinite Craft", url: "https://maddox05.github.io/basic-ruffle-player/html/nova_craft/index.html", img: "https://play-lh.googleusercontent.com/YJFHGSmrMGuUqyWZ0oZDgDtDErIU2jQY3yT_PG9IRL6s5dBLmKXrXQShM3n8HFoPhkM=w240-h480-rw"},
  {name: "Knife Hit", url: "https://gavintheman.vercel.app/semag/knifehit/index.html", img: "https://play-lh.googleusercontent.com/Xi15vMCqH2Ke5ndbpP86LAE2djl58hEpTZvnCF2sKUkd7C9D_x-cOGiR6HhsIOUS9Q"},
  {name: "Magic Tiles", url: "https://script.google.com/macros/s/AKfycbzsriooEqdtLu3zcG2AUjtLNeqgETUcTv5duzFgEKlIZAZZsYlq49sR2aN6nSwsAjcs/exec", img: "https://play-lh.googleusercontent.com/u94NKpNjH1sBOiKHevX3_ATM-ozNHg6b186oU9GfnPnHwbdJ7RaeipkCRcVPdf1KRA"},
  {name: "Swerve", url: "https://s3-eu-west-1.amazonaws.com/apps.playcanvas.com/VecAxR3e/index.html", img: "https://play-lh.googleusercontent.com/P308WGnDs89S9N4QKatc20TBa_vc72evFwg5n8dsNpDNbCKzb4IGm9i2vLBpKex50gY=w600-h300-pc0xffffff-pd"},
  {name: "Minecraft 1.12.2", url: "https://element-games-v5.vercel.app/g/source/minecraft-1.12/index.html", img: "https://images.icon-icons.com/2699/PNG/512/minecraft_logo_icon_168974.png"},
  {name: "Monkey Mart", url: "https://studyschool.netlify.app/g/monkey-mart", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/monkey-mart.webp"},
  {name: "Moto X3M", url: "https://script.google.com/macros/s/AKfycbw7_zG02ZMXnPSdwCx0CcmN8eX_0Bk3715TSP-Eglb1DyVhp7RxShuXq4qJ8Q2s7cnW/exec", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/motox3m.webp"},
  {name: "Obby on a Bike", url: "https://element-games-v5.vercel.app/g/source/obby-on-a-bike/index.html", img: "https://play-lh.googleusercontent.com/YwxYsY3FW_zhGTZuYjT9MOpv48FKKl90uyM4eyqOjVCPLEbosk2NALJc64arXdPhjq7d"},
  {name: "Climb Simulator", url: "https://script.google.com/macros/s/AKfycbzUPEYWyiXAsI-wbbg-NbWW6ZAZF1FlSqACKLaEQMvPbnqP5zeGHck2VpwfJ9yoO3o7/exec", img: "https://play-lh.googleusercontent.com/BAVIJZwYbS5R02NnvzKGl4Y2xJfUnX0EzrEwwEbnxBMty44EFqTZRFgDRuHLeLZ7NvEE5pC0iBKKeHe44pEyGQ"},
  {name: "Pacman", url: "https://element-games-v5.vercel.app/g/source/pacman/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/pacman.webp"},
  {name: "Papa Louie", url: "https://script.google.com/macros/s/AKfycbyR3khxh-b0yaOgR_d-BqnPEHVrv4kRYteyWOCHT_u-ekBD_d5nMIM-3EK0Pd0e2aGe/exec", img: "https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=1200,height=1200,fit=cover,f=png/f54dee3512ad75e89cc256c6bec22f06/papa-louie-when-pizzas-attack.jpeg"},
  {name: "Papa Louie 2", url: "https://script.google.com/macros/s/AKfycby4Ye7CbYCL3GzlZxZgtpIlt9Uv5RYUeHNKj8O9sg55h9hXZrtPiS58EVb4F32GpgnS/exec", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/papalouie2_100x100%20(1).webp"},
  {name: "Papa Louie 3", url: "https://script.google.com/macros/s/AKfycbzbrDYt2vNFxtv_BluWd3wHs0IcDt7chTXESLmT4UimQrfD1fjPwDmEKKomEWw74cXpqA/exec", img: "https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=1200,height=1200,fit=cover,f=png/6e885a340550b9f7985deccc952db551/papa-louie-3.png"},
  {name: "Papa's Burgeria", url: "https://gavintheman.vercel.app/semag/papasburgeria/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/burger.webp"},
  {name: "Papa's Freezeria", url: "https://gavintheman.vercel.app/semag/papasfreezeria/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/icecream.webp"},
  {name: "Papa's Hotdoggeria", url: "https://gavintheman.vercel.app/semag/papashotdoggeria/index.html", img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS-KwpYmG_9veRHvvfU1xSLP9V5Z4-NG0YUNZG0rXbGvQ&s=10"},
  {name: "Papa's Pancakeria", url: "https://gavintheman.vercel.app/semag/papaspancakeria/index.html", img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRK2yYV4W35JF3qhAMf1PWW5u04eSCR976E6LaN5-xTAQ&s=10"},
  {name: "Papa's Pastaria", url: "https://gavintheman.vercel.app/semag/papaspastaria/index.html", img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTMQlO58zj9CDs3IQMyIWq9S4qtFMAzmGARfONOsLKQjw&s=10"},
  {name: "Papa's Pizzeria", url: "https://gavintheman.vercel.app/semag/papaspizzeria/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/papapizza.webp"},
  {name: "Papa's Sushiria", url: "https://gavintheman.vercel.app/semag/papassushiria/index.html", img: "https://www.culinaryschools.org/kids-games/papas-sushiria/papas-sushiria.jpg"},
  {name: "Papa's Tacomia", url: "https://gavintheman.vercel.app/semag/papastacomia/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/taco.webp"},
  {name: "Papa's Wingeria", url: "https://gavintheman.vercel.app/semag/papaswingeria/index.html", img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQZfK-B1alJVGqZQjFz__cCTuc4dn_ofLTJG8PpMDBjhw&s=10"},
  {name: "Paper.io 2", url: "https://games.proll.dev/g/paperio2/", img: "https://math711.github.io/img/class-505.png"},
  {name: "Football Bros", url: "https://maddox05.github.io/basic-ruffle-player/html/football_bros/index.html", img: "https://images.igdb.com/igdb/image/upload/t_cover_big_2x/co951q.jpg"},
  {name: "Rise Higher", url: "https://gavintheman.vercel.app/semag/risehigher/index.html", img: "https://images.hellokids.com/_uploads/_tiny_galerie/20190624/vign-rise-higher-hk-eyc_424.jpg"},
  {name: "Roblox Obby", url: "https://script.google.com/macros/s/AKfycbx-uaFWRwY1q4Gv7pRrd9PR3zbbmsKV5PTGPQZ11-u3EWCiD4xeM2V3_1JBvmJQNxSshw/exec", img: "https://play-lh.googleusercontent.com/KAz3HyTAVv6kKFVIdDKoHtp0_QsfVfzozrbt8p-iSE6SHTVJikcXtPtYDDN3yqk4LjKJHCWO9UdBQn0QeYw4"},
  {name: "Retro Bowl", url: "https://games.proll.dev/g/retro-bowl/", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/retro_bowl_icon.webp"},
  {name: "Retro Bowl College", url: "https://maddox05.github.io/basic-ruffle-player/html/retro_bowl_college/index.html", img: "https://img.poki-cdn.com/cdn-cgi/image/quality=78,width=314,height=314,fit=cover,f=auto/d98547374c4129bf441b754d495e41aa.png"},
  {name: "Slope", url: "https://raw.githack.com/skoolgq/Polaris-Assets/main/slope/index.html", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/slope.webp"},
  {name: "Stack", url: "https://gavintheman.vercel.app/semag/stack/index.html", img: "https://childrenandmedia.org.au/assets/images/app-reviews/Stack.png"},
  {name: "Bridge Race", url: "https://maddox05.github.io/basic-ruffle-player/html/bridge_race/index.html", img: "https://play-lh.googleusercontent.com/ym7hOY7sjtsuZ-CR2tmvtsNEgPTkufUPKdaUKcNHOvJS3bf7CIxA7Eyc23FbnzziPsc"},
  {name: "Stickman Hook", url: "https://stigmabeanyay.netlify.app/games/stickmanhook/", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/stickmanhook.webp"},
  {name: "Subway Surfers", url: "https://stigmabeanyay.netlify.app/games/subwaysurfers/", img: "https://raw.githubusercontent.com/duckmath/icons/refs/heads/main/subway.webp"},
  {name: "The Impossible Quiz", url: "https://maddox05.github.io/basic-ruffle-player/html/theimpossiblequiz/index.html", img: "https://math711.github.io/img/class-480.png"},
  {name: "Time Shooter 2", url: "https://element-games-v5.vercel.app/g/source/time-shooter-2/index.html", img: "https://img.gamedistribution.com/62a72f2da7cb4b609579a47653546e6a-512x512.jpeg"},
  {name: "Time Shooter 3", url: "https://element-games-v5.vercel.app/g/source/time-shooter-3/index.html", img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRQUFhypuMj6cRanchYLs25DH9EUy5gOe74-g&s"},
  {name: "Tiny Fishing", url: "https://stigmabeanyay.netlify.app/games/tinyfishing/", img: "https://math711.github.io/img/class-451.png"},
  {name: "Wordle Unlimited", url: "https://element-games-v5.vercel.app/g/source/wordle/index.html#daily", img: "https://static01.nyt.com/images/2022/03/02/crosswords/alpha-wordle-icon-new/alpha-wordle-icon-new-smallSquare252-v3.png?format=pjpg&quality=75&auto=webp&disable=upscale"},
  {name: "YoHoHo!", url: "https://gavintheman.vercel.app/semag/yohoho/index.html", img: "https://math711.github.io/img/class-828.png"}
];

defaultGames.sort((a, b) => {
  const nameA = a.name.toUpperCase();
  const nameB = b.name.toUpperCase();

  if (nameA < nameB) return -1;
  if (nameA > nameB) return 1;
  return 0;
});

const multiGames = [
  {name: "Basket Random", url: "https://maddox05.github.io/basic-ruffle-player/html/basket_random/index.html"},
  {name: "Boxing Random", url: "https://element-games-v5.vercel.app/g/source/boxing-random/index.html"},
  {name: "Tag", url: "https://script.google.com/macros/s/AKfycby2Crs4kcY3H8tDRHQp1JRJNd_v8_zYBjwU-qF2trfXQWAeWpW1vFVzGgQdv-Ejmq6P/exec"},  
  {name: "Fireboy & Watergirl", url: "https://seraph-bi6hosts.vercel.app/games/fireboywatergirl/index.html"},
  {name: "Getaway Shootout", url: "games/getaway-shootout/"},
  {name: "Minecraft 1.12.2", url: "https://element-games-v5.vercel.app/g/source/minecraft-1.12/index.html"},
  {name: "Retro Bowl", url: "https://studyschool.netlify.app/g/retro-bowl/"},
];

multiGames.sort((a, b) => {
  const nameA = a.name.toUpperCase();
  const nameB = b.name.toUpperCase();

  if (nameA < nameB) return -1;
  if (nameA > nameB) return 1;
  return 0;
});

const puzzleGames = [
  {name: "2048", url: "games/2048/"},
  {name: "Block Blast", url: "https://maddox05.github.io/basic-ruffle-player/html/blocky_puzzle/index.html"},
  {name: "Bloxors", url: "https://seraph-bi6hosts.vercel.app/games/bloxors/index.html"},
  {name: "Save My Pet", url: "https://script.google.com/macros/s/AKfycbzzzBlqpi-UH1EolZkm_TwyvFbgdV6fuWz_IjtPNgQ8ZhiPtGODuz0NvWvNlMUVWoeS/exec"},
  {name: "Fireboy & Watergirl", url: "https://seraph-bi6hosts.vercel.app/games/fireboywatergirl/index.html"},
  {name: "Stack", url: "https://seraph-bi6hosts.vercel.app/games/stack/index.html"},
  {name: "The Impossible Quiz", url: "https://seraph-bi6hosts.vercel.app/games/theimpossiblequiz/index.html"},
  {name: "Wordle Unlimited", url: "https://element-games-v5.vercel.app/g/source/wordle/index.html#daily"},
];

puzzleGames.sort((a, b) => {
  const nameA = a.name.toUpperCase();
  const nameB = b.name.toUpperCase();

  if (nameA < nameB) return -1;
  if (nameA > nameB) return 1;
  return 0;
});

const obbyGames = [
  {name: "Obby on a Bike", url: "https://element-games-v5.vercel.app/g/source/obby-on-a-bike/index.html"},
  {name: "Roblox Obby", url: "https://script.google.com/macros/s/AKfycbx-uaFWRwY1q4Gv7pRrd9PR3zbbmsKV5PTGPQZ11-u3EWCiD4xeM2V3_1JBvmJQNxSshw/exec"},
];

const sportsGames = [
  {name: "Retro Bowl", url: "https://studyschool.netlify.app/g/retro-bowl/"},
  {name: "Retro Bowl College", url: "https://maddox05.github.io/basic-ruffle-player/html/retro_bowl_college/index.html"},
  {name: "Basketball Stars", url: "games/basketball-stars/"},
  {name: "Basket Random", url: "https://maddox05.github.io/basic-ruffle-player/html/basket_random/index.html"},
  {name: "Boxing Random", url: "https://element-games-v5.vercel.app/g/source/boxing-random/index.html"},
  {name: "Backyard Baseball", url: "https://script.google.com/macros/s/AKfycbxCGoMs4wmjd_c08SeWaKuJKh9BoQlovbZIbPtzK03OLOQ6CmmImR9s6HpsxCtaHYbi/exec"},
  {name: "Backyard Basketball", url: "https://script.google.com/macros/s/AKfycbzutG_IKsHOQPExLK1OU1gKUy0FzeES71P13XgouwmJWvJaDi8U26ivFGRD_IHuFIDJ/exec"},
];

sportsGames.sort((a, b) => {
  const nameA = a.name.toUpperCase();
  const nameB = b.name.toUpperCase();

  if (nameA < nameB) return -1;
  if (nameA > nameB) return 1;
  return 0;
});

obbyGames.sort((a, b) => {
  const nameA = a.name.toUpperCase();
  const nameB = b.name.toUpperCase();

  if (nameA < nameB) return -1;
  if (nameA > nameB) return 1;
  return 0;
});

const quotes = [
  "Stealth isn‚Äôt hiding. It‚Äôs blending in.",
  "Not sure where to start? Try a random game.",
  "You can‚Äôt block what you can‚Äôt detect.",
  "Freedom starts with a tab.",
  "Kuppy is watching you‚Ä¶ but in a friendly way.",
  "KuppyCloaker is better enjoyed with friends.",
  "I told my computer a joke. It laughed in binary.",
  "Remember: Every button has consequences.",
  "This isn‚Äôt a bug. It‚Äôs a feature.",
  "If this page was a sandwich, it‚Äôd be extra cheesy.",
  "KuppyCloaker: Making procrastination look productive.",
  "Click responsibly. Or don‚Äôt. Whatever.",
  "Somebody call tech support. Or maybe not.",
  "Your Wi-Fi secretly judges you.",
  "Clicking random things builds character.",
  "Click here‚Ä¶ actually don‚Äôt, maybe.",
  "This page self-destructs in 3‚Ä¶ 2‚Ä¶ just kidding.",
  "Don‚Äôt ask me how this works. I don‚Äôt know either.",
  "Don‚Äôt read this aloud. Unless you want to.",
  "Kuppy believes in you. Mostly.",
  "Fun fact: This page contains 0 calories.",
  "Smiles are contagious. So are pop-ups.",
  "Do not try to hack this‚Ä¶ unless you‚Äôre me.",
  "Cloak smart. Play smarter.",
  "The web, unfiltered.",
  "No limits, no traces, no problem."
];

const quoteEl = document.getElementById("welcomeSubtext");
quoteEl.textContent = quotes[Math.floor(Math.random() * quotes.length)];
quoteEl.style.animation = 'fadeInScale 0.8s ease-out 0.3s both';

const canvas = document.getElementById('particleCanvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

class Particle {
  constructor() {
    this.x = Math.random() * canvas.width;
    this.y = Math.random() * canvas.height;
    this.size = Math.random() * 3 + 1;
    this.speedX = Math.random() * 0.5 - 0.25;
    this.speedY = Math.random() * 0.5 - 0.25;
    this.opacity = Math.random() * 0.5 + 0.2;
  }
  
  update() {
    this.x += this.speedX;
    this.y += this.speedY;
    
    if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
    if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
  }
  
  draw() {
    ctx.fillStyle = `rgba(147, 163, 184, ${this.opacity})`;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
  }
}

const particles = [];
for (let i = 0; i < 80; i++) {
  particles.push(new Particle());
}

const trail = [];
const trailLength = 8;

document.addEventListener('mousemove', (e) => {
  trail.push({ x: e.clientX, y: e.clientY, time: Date.now() });
  
  if (trail.length > trailLength) {
    trail.shift();
  }
});

function drawCursorTrail() {
  const now = Date.now();
  
  trail.forEach((point, index) => {
    const age = now - point.time;
    if (age < 500) {
      const opacity = (1 - age / 500) * 0.3;
      const size = 3 - (age / 500) * 2;
      
      ctx.fillStyle = `rgba(0, 123, 255, ${opacity})`;
      ctx.beginPath();
      ctx.arc(point.x, point.y, size, 0, Math.PI * 2);
      ctx.fill();
    }
  });
}

function animateParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  particles.forEach(particle => {
    particle.update();
    particle.draw();
  });
  
  drawCursorTrail();
  
  requestAnimationFrame(animateParticles);
}

animateParticles();

window.addEventListener('load',()=>{
  document.body.classList.add('loaded');

  const savedTabName = localStorage.getItem('kuppyTabName');
  if(savedTabName) document.title = savedTabName;

  const savedTheme = JSON.parse(localStorage.getItem('kuppyTheme')) || {accent:'#007bff', bg:'#0f1724', card:'#0b1220'};
  const isLight = localStorage.getItem('kuppyLightMode') === 'true';

  document.documentElement.style.setProperty('--accent', savedTheme.accent);
  document.documentElement.style.setProperty('--bg', isLight ? lighten(savedTheme.bg) : savedTheme.bg);
  document.documentElement.style.setProperty('--card', isLight ? lighten(savedTheme.card) : savedTheme.card);
  document.documentElement.style.setProperty('--text', isLight ? '#111' : '#e6eef8');

  if(isLight) document.body.classList.add('light');
});

const text="KuppyCloaker"; let i=0;

function startTyping(){document.getElementById("typedTitle").textContent=""; typeTitle();}

function typeTitle(){if(i<text.length){document.getElementById("typedTitle").textContent+=text.charAt(i);i++;setTimeout(typeTitle,120);}}

function lighten(hex){
  const c = parseInt(hex.slice(1),16);
  const r = Math.min(255, ((c>>16)+51));
  const g = Math.min(255, (((c>>8)&0x00FF)+51));
  const b = Math.min(255, ((c&0x0000FF)+51));
  return `rgb(${r},${g},${b})`;
}

function openWebsite(url) {
  if (!url) return;
  if (!url.startsWith('http')) url = 'https://' + url;

  const overlay = document.getElementById('fadeOverlay');
  overlay.classList.add('active');

  setTimeout(() => {
    const win = window.open('', '_blank');
    win.document.write(`
<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='referrer' content='no-referrer'>
  <title>New Tab</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: black;
    }

    embed {
      width: 100%;
      height: 100%;
      border: none;
    }

    #backBtn {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 1000;
      background: rgba(0,0,0,0.6);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      padding: 6px 12px;
      cursor: pointer;
      font-family: system-ui, sans-serif;
      transition: background 0.2s;
    }

    #backBtn:hover {
      background: rgba(255,255,255,0.2);
    }

    #fadeOverlay {
      position: fixed;
      inset: 0;
      background: black;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.6s ease;
      z-index: 2000;
    }

    #fadeOverlay.active {
      opacity: 1;
    }
  </style>
</head>
<body>
  <button id="backBtn">‚¨Ö</button>
  <div id="fadeOverlay"></div>
  <embed src='${url}'></embed>

<script>
  const backBtn = document.getElementById('backBtn');
  const fadeOverlay = document.getElementById('fadeOverlay');

  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      fadeOverlay.classList.add('active');
      setTimeout(() => {
        window.close();
      }, 1);
    }
  });

  backBtn.onclick = () => {
    fadeOverlay.classList.add('active');
    setTimeout(() => {
      window.close();
    }, 600);
  };
  <\/script>
</body>
</html>
`);
overlay.classList.remove('active');
}, 500);
}

function rememberRecentGame(game) {
  localStorage.setItem('recentGame', JSON.stringify(game));
}

function createGameCard(g, idx, savedArray, starredArray, categoryLength, reloadFn) {
  const div = document.createElement('div');
  div.className = 'card';

  const imgSrc = g.img || (defaultGames.find(d => d.name === g.name) || {}).img || null;
  if (imgSrc) {
    const img = document.createElement('img');
    img.src = imgSrc;
    img.alt = g.name;
    img.style.borderRadius = 'inherit';
    img.onerror = () => {
      img.style.display = 'none';
      div.style.background = 'linear-gradient(135deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02))';
    };
    div.appendChild(img);
  }

  const overlay = document.createElement('div');
  overlay.className = 'card-title';
  overlay.textContent = g.name;
  overlay.style.pointerEvents = 'none';
  div.appendChild(overlay);

  const starBtn = document.createElement('button');
  starBtn.className = 'starBtn';
  if (starredArray && starredArray.includes(g.name)) starBtn.classList.add('starred');
  starBtn.innerHTML = '‚òÖ';
  starBtn.onclick = (e) => {
    e.stopPropagation();
    let s = JSON.parse(localStorage.getItem('starredGames') || '[]');
    if (s.includes(g.name)) {
      s = s.filter(x => x !== g.name);
      starBtn.classList.remove('starred');
    } else {
      s.push(g.name);
      starBtn.classList.add('starred');
    }
    localStorage.setItem('starredGames', JSON.stringify(s));
    displayStarredGames();
    if (typeof reloadFn === 'function') reloadFn();
  };
  div.appendChild(starBtn);

  if (typeof categoryLength === 'number' && idx >= categoryLength) {
    const del = document.createElement('button');
    del.className = 'deleteBtn';
    del.textContent = '‚ùå';
    del.onclick = (e) => {
      e.stopPropagation();
      const updated = (savedArray || []).filter(x => x.name !== g.name);
      localStorage.setItem('customPresets', JSON.stringify(updated));
      if (typeof reloadFn === 'function') reloadFn();
    };
    div.appendChild(del);
  }

  div.onclick = () => openWebsite(g.url);

  return div;
}

function displayStarredGames() {
  const container = document.getElementById('starredGamesContainer');
  container.innerHTML = '';
  
  const starred = JSON.parse(localStorage.getItem('starredGames') || '[]');
  if (starred.length === 0) return;
  
  const saved = JSON.parse(localStorage.getItem('customPresets') || '[]');
  const allGames = [...defaultGames, ...saved];
  
  const starredGames = allGames.filter(g => starred.includes(g.name));
  
  const savedPositions = JSON.parse(localStorage.getItem('starredGamePositions') || '{}');
  
  const defaultPositions = [
    { top: '10%', left: '2%' },
    { top: '30%', left: '2%' },
    { top: '50%', left: '2%' },
    { top: '70%', left: '2%' },
    { top: '10%', right: '2%' },
    { top: '30%', right: '2%' },
    { top: '50%', right: '2%' },
    { top: '70%', right: '2%' },
  ];
  
  starredGames.forEach((game, idx) => {
    const icon = document.createElement('div');
    icon.className = 'starred-game-icon';
    icon.dataset.gameName = game.name;
    
    const imgSrc = game.img || (defaultGames.find(d => d.name === game.name) || {}).img;
    if (imgSrc) {
      const img = document.createElement('img');
      img.src = imgSrc;
      img.alt = game.name;
      img.draggable = false;
      icon.appendChild(img);
    }
    
    const savedPos = savedPositions[game.name];
    if (savedPos) {
      icon.style.left = savedPos.left;
      icon.style.top = savedPos.top;
      icon.style.right = 'auto';
      icon.style.bottom = 'auto';
    } else if (idx < defaultPositions.length) {
      Object.assign(icon.style, defaultPositions[idx]);
    }
    
    icon.style.animationDelay = `${idx * 0.1}s`;
    
    makeDraggable(icon, game);
    
    container.appendChild(icon);
  });
}

function makeDraggable(element, game) {
  let isDragging = false;
  let startX, startY, initialLeft, initialTop;
  let hasMoved = false;
  
  element.addEventListener('mousedown', (e) => {
    isDragging = true;
    hasMoved = false;
    element.classList.add('dragging');
    
    const rect = element.getBoundingClientRect();
    startX = e.clientX;
    startY = e.clientY;
    initialLeft = rect.left;
    initialTop = rect.top;
    
    element.style.right = 'auto';
    element.style.bottom = 'auto';
    element.style.left = initialLeft + 'px';
    element.style.top = initialTop + 'px';
    
    e.preventDefault();
  });
  
  document.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    
    const deltaX = e.clientX - startX;
    const deltaY = e.clientY - startY;
    
    if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {
      hasMoved = true;
    }
    
    const newLeft = initialLeft + deltaX;
    const newTop = initialTop + deltaY;
    const maxLeft = window.innerWidth - element.offsetWidth;
    const maxTop = window.innerHeight - element.offsetHeight;
    
    element.style.left = Math.max(0, Math.min(newLeft, maxLeft)) + 'px';
    element.style.top = Math.max(0, Math.min(newTop, maxTop)) + 'px';
  });
  
  document.addEventListener('mouseup', (e) => {
    if (!isDragging) return;
    
    isDragging = false;
    element.classList.remove('dragging');
    
    if (!hasMoved) {
      openWebsite(game.url);
      rememberRecentGame(game);
    } else {
      const savedPositions = JSON.parse(localStorage.getItem('starredGamePositions') || '{}');
      savedPositions[game.name] = {
        left: element.style.left,
        top: element.style.top
      };
      localStorage.setItem('starredGamePositions', JSON.stringify(savedPositions));
    }
  });
}

document.getElementById('randomGameBtn').onclick = () => {
  const saved = JSON.parse(localStorage.getItem('customPresets') || '[]');
  const allGames = [...defaultGames, ...saved];
  if (allGames.length === 0) return alert('No games available!');
  const randomGame = allGames[Math.floor(Math.random() * allGames.length)];
  openWebsite(randomGame.url);
  rememberRecentGame(randomGame);
};

document.getElementById('recentGamesBtn').onclick = () => {
  const recent = JSON.parse(localStorage.getItem('recentGame'));
  if (!recent) return alert('No recent game yet!');
  openWebsite(recent.url);
};

function loadGamesPage(){
  const grid=document.getElementById('allGamesGrid');
  grid.innerHTML='';
  const saved=JSON.parse(localStorage.getItem('customPresets')||'[]');
  const starred=JSON.parse(localStorage.getItem('starredGames')||'[]');
  const allGames = [...defaultGames,...saved];

  allGames.sort((a,b)=>{
    const aStar=starred.includes(a.name);
    const bStar=starred.includes(b.name);
    if(aStar && !bStar) return -1;
    if(!aStar && bStar) return 1;
    return 0;
  });

  allGames.forEach((g, idx) => {
    const card = createGameCard(g, idx, saved, starred, defaultGames.length, loadGamesPage);
    grid.appendChild(card);
  });
}

function loadpuzzleGamesPage(){
  const grid=document.getElementById('puzzleGamesGrid');
  grid.innerHTML='';
  const saved=JSON.parse(localStorage.getItem('customPresets')||'[]');
  const starred=JSON.parse(localStorage.getItem('starredGames')||'[]');
  const allGames = [...puzzleGames,...saved];

  allGames.sort((a,b)=>{
    const aStar=starred.includes(a.name);
    const bStar=starred.includes(b.name);
    if(aStar && !bStar) return -1;
    if(!aStar && bStar) return 1;
    return 0;
  });

  allGames.forEach((g, idx) => {
    const card = createGameCard(g, idx, saved, starred, puzzleGames.length, loadpuzzleGamesPage);
    grid.appendChild(card);
  });
}

function loadobbyGamesPage(){
  const grid=document.getElementById('obbyGamesGrid');
  grid.innerHTML='';
  const saved=JSON.parse(localStorage.getItem('customPresets')||'[]');
  const starred=JSON.parse(localStorage.getItem('starredGames')||'[]');
  const allGames = [...obbyGames,...saved];

  allGames.sort((a,b)=>{
    const aStar=starred.includes(a.name);
    const bStar=starred.includes(b.name);
    if(aStar && !bStar) return -1;
    if(!aStar && bStar) return 1;
    return 0;
  });

  allGames.forEach((g, idx) => {
    const card = createGameCard(g, idx, saved, starred, obbyGames.length, loadobbyGamesPage);
    grid.appendChild(card);
  });
}

function loadsportsGamesPage(){
  const grid=document.getElementById('sportsGamesGrid');
  grid.innerHTML='';
  const saved=JSON.parse(localStorage.getItem('customPresets')||'[]');
  const starred=JSON.parse(localStorage.getItem('starredGames')||'[]');
  const allGames = [...sportsGames,...saved];

  allGames.sort((a,b)=>{
    const aStar=starred.includes(a.name);
    const bStar=starred.includes(b.name);
    if(aStar && !bStar) return -1;
    if(!aStar && bStar) return 1;
    return 0;
  });

  allGames.forEach((g, idx) => {
    const card = createGameCard(g, idx, saved, starred, sportsGames.length, loadsportsGamesPage);
    grid.appendChild(card);
  });
}

function loadmultiGamesPage(){
  const grid=document.getElementById('multiGamesGrid');
  grid.innerHTML='';
  const saved=JSON.parse(localStorage.getItem('customPresets')||'[]');
  const starred=JSON.parse(localStorage.getItem('starredGames')||'[]');
  const allGames = [...multiGames,...saved];

  allGames.sort((a,b)=>{
    const aStar=starred.includes(a.name);
    const bStar=starred.includes(b.name);
    if(aStar && !bStar) return -1;
    if(!aStar && bStar) return 1;
    return 0;
  });

  allGames.forEach((g, idx) => {
    const card = createGameCard(g, idx, saved, starred, multiGames.length, loadmultiGamesPage);
    grid.appendChild(card);
  });
}

function showGamesPage(){
  const home=document.getElementById('homePage');
  const games=document.getElementById('gamesPage');
  const multi=document.getElementById('multigamesPage');
  const puzzle=document.getElementById('puzzlegamesPage');
  const obby=document.getElementById('obbygamesPage');
  home.style.opacity='1';
  games.style.display='flex';
  multi.style.display='1';
  document.getElementById('infoShell').style.display = 'none';
  puzzle.style.display='1';
  obby.style.display='1';
  requestAnimationFrame(()=>{
    home.style.transition='opacity 0.5s';
    home.style.opacity='0';
    setTimeout(()=>{
      home.style.display='none';
      games.classList.add('show');
      loadGamesPage();
    },500);
  });
}

function showMultiGamesPage(){
  const home=document.getElementById('homePage');
  const games=document.getElementById('gamesPage');
  const multi=document.getElementById('multigamesPage');
  const puzzle=document.getElementById('puzzlegamesPage');
  const obby=document.getElementById('obbygamesPage');
  home.style.opacity='1';
  games.style.display='1';
  multi.style.display='flex';
  document.getElementById('infoShell').style.display = 'none';
  puzzle.style.display='1';
  obby.style.display='1';
  requestAnimationFrame(()=>{
    home.style.transition='opacity 0.5s';
    home.style.opacity='0';
    setTimeout(()=>{
      home.style.display='none';
      multi.classList.add('show');
      loadmultiGamesPage();
    },500);
  });
}

function showPuzzleGamesPage(){
  const home=document.getElementById('homePage');
  const games=document.getElementById('gamesPage');
  const multi=document.getElementById('multigamesPage');
  const puzzle=document.getElementById('puzzlegamesPage');
  const obby=document.getElementById('obbygamesPage');
  home.style.opacity='1';
  games.style.display='1';
  multi.style.display='1';
  document.getElementById('infoShell').style.display = 'none';
  puzzle.style.display='flex';
  obby.style.display='1';
  requestAnimationFrame(()=>{
    home.style.transition='opacity 0.5s';
    home.style.opacity='0';
    setTimeout(()=>{
      home.style.display='none';
      puzzle.classList.add('show');
      loadpuzzleGamesPage();
    },500);
  });
}

function showObbyGamesPage(){
  const home=document.getElementById('homePage');
  const games=document.getElementById('gamesPage');
  const multi=document.getElementById('multigamesPage');
  const puzzle=document.getElementById('puzzlegamesPage');
  const obby=document.getElementById('obbygamesPage');
  const sports=document.getElementById('sportsgamesPage');
  home.style.opacity='1';
  games.style.display='1';
  multi.style.display='1';
  document.getElementById('infoShell').style.display = 'none';
  puzzle.style.display='1';
  sports.style.display='1';
  obby.style.display='flex';
  requestAnimationFrame(()=>{
    home.style.transition='opacity 0.5s';
    home.style.opacity='0';
    setTimeout(()=>{
      home.style.display='none';
      obby.classList.add('show');
      loadobbyGamesPage();
    },500);
  });
}

function showHomePage(){
  const home=document.getElementById('homePage');
  const games=document.getElementById('gamesPage');
  const multi=document.getElementById('multigamesPage');
  const puzzle=document.getElementById('puzzlegamesPage');
  const obby=document.getElementById('obbygamesPage');
  const sports=document.getElementById('sportsgamesPage');
  games.classList.remove('show');
  multi.classList.remove('show');
  puzzle.classList.remove('show');
  document.getElementById('infoShell').style.display = 'flex';
  obby.classList.remove('show');
  sports.classList.remove('show');
  setTimeout(()=>{
    games.style.display='none';
    multi.style.display='none';
    puzzle.style.display='none';
    obby.style.display='none';
    sports.style.display='none';
    home.style.display='block';
    requestAnimationFrame(()=>{
      home.style.opacity='1';
      displayStarredGames();
    });
  },500);
}

document.getElementById('websiteInput').addEventListener('keydown', (event) => {
  if (event.key === 'Enter') {
    const url = document.getElementById('websiteInput').value.trim();
    openWebsite(url);
  }
});

document.getElementById('loginPassword').addEventListener('keydown', (event) => {
  if (event.key === 'Enter') {
 const user = loginUsername.value.trim();
  const pass = loginPassword.value.trim();

  if (!user || !pass) {
    loginMsg.textContent = "Enter username & password";
    return;
  }

  if (!(users[user] === pass || pass === weeklyPassword)) {
    loginMsg.textContent = "Incorrect username or password";
    return;
  }

  loginShell.classList.add('hidden');
  setTimeout(() => {
    loginShell.style.display = 'none';
    document.getElementById('infoShell').style.display = 'flex';
    homePage.style.display = 'block';
    setTimeout(() => {
      homePage.classList.remove('hidden');
      startTyping();
    }, 10);
    userDisplay.textContent = user;
    displayStarredGames();
  }, 500);
  }
});

document.getElementById('allGamesBtn').onclick=showGamesPage;
document.getElementById('multiGamesBtn').onclick=showMultiGamesPage;
document.getElementById('puzzleGamesBtn').onclick=showPuzzleGamesPage;
document.getElementById('obbyGamesBtn').onclick=showObbyGamesPage;
document.getElementById('sportsGamesBtn').onclick=showSportsGamesPage;
document.getElementById('backBtn').onclick=showHomePage;
document.getElementById('multiBackBtn').onclick=showHomePage;
document.getElementById('puzzleBackBtn').onclick=showHomePage;
document.getElementById('obbyBackBtn').onclick=showHomePage;
document.getElementById('sportsBackBtn').onclick=showHomePage;

function showSportsGamesPage(){
  const home=document.getElementById('homePage');
  const games=document.getElementById('gamesPage');
  const multi=document.getElementById('multigamesPage');
  const puzzle=document.getElementById('puzzlegamesPage');
  const obby=document.getElementById('obbygamesPage');
  const sports=document.getElementById('sportsgamesPage');
  home.style.opacity='0';
  games.style.display='none';
  multi.style.display='none';
  document.getElementById('infoShell').style.display = 'none';
  puzzle.style.display='none';
  obby.style.display='none';
  sports.style.display='flex';
  requestAnimationFrame(()=>{
    home.style.transition='opacity 0.5s';
    setTimeout(()=>{
      home.style.display='none';
      sports.classList.add('show');
      loadsportsGamesPage();
    },500);
  });
}

document.getElementById('lightToggle').onclick = () => {
  const isLight = document.body.classList.toggle('light');
  localStorage.setItem('kuppyLightMode', isLight);
  const savedTheme = JSON.parse(localStorage.getItem('kuppyTheme')) || {bg:'#0f1724', card:'#0b1220'};
  if(isLight){
    document.documentElement.style.setProperty('--bg', lighten(savedTheme.bg));
    document.documentElement.style.setProperty('--card', lighten(savedTheme.card));
    document.documentElement.style.setProperty('--text', '#111');
  } else {
    document.documentElement.style.setProperty('--bg', savedTheme.bg);
    document.documentElement.style.setProperty('--card', savedTheme.card);
    document.documentElement.style.setProperty('--text', '#e6eef8');
  }
};

let themeIndex = 0;
const themes = [
  { accent: '#FF0000', bg: '#2b0a0a', card: '#1b0505' },
  { accent: '#FF7F00', bg: '#2c1400', card: '#1f0a00' },
  { accent: '#FFFF00', bg: '#2b2b00', card: '#1a1a00' },
  { accent: '#00FF00', bg: '#002b00', card: '#001a00' },
  { accent: '#BFFF00', bg: '#1a2b00', card: '#0d1500' },
  { accent: '#00FFFF', bg: '#002b2b', card: '#001a1a' },
  { accent: '#0000FF', bg: '#00002b', card: '#00001a' },
  { accent: '#4B0082', bg: '#10002b', card: '#080015' },
  { accent: '#8B00FF', bg: '#1a002b', card: '#100015' },
  { accent: '#FFD700', bg: '#2b2200', card: '#1a1600' },
  { accent: '#C0C0C0', bg: '#2b2b2b', card: '#1a1a1a' },
  { accent: '#50C878', bg: '#002b1a', card: '#00140d' },
  { accent: '#9B111E', bg: '#2b0005', card: '#1a0002' },
  { accent: '#CCCCFF', bg: '#1a1a2b', card: '#0d0d15' },
  { accent: '#B87333', bg: '#2b1a0f', card: '#1a0d08' },
  { accent: '#B9F2FF', bg: '#1a2b2b', card: '#0d1515' }
];
document.getElementById('colorToggle').onclick=()=>{
  themeIndex=(themeIndex+1)%themes.length;
  const t=themes[themeIndex];
  localStorage.setItem('kuppyTheme', JSON.stringify(t));
  const isLight = document.body.classList.contains('light');
  document.documentElement.style.setProperty('--accent', t.accent);
  document.documentElement.style.setProperty('--bg', isLight ? lighten(t.bg) : t.bg);
  document.documentElement.style.setProperty('--card', isLight ? lighten(t.card) : t.card);
};

function getDailyGame() {
  const saved = JSON.parse(localStorage.getItem('customPresets') || '[]');
  const allGames = [...defaultGames, ...saved];
  if (allGames.length === 0) return alert('No games available!');

  const date = new Date();
  const dayOfYear = Math.floor(
    (Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()) -
     Date.UTC(date.getFullYear(), 0, 0)) / 24 / 60 / 60 / 1000
  );

  const index = dayOfYear % allGames.length;
  const dailyGame = allGames[index];

  openWebsite(dailyGame.url);
}

document.getElementById('dailyGameBtn').onclick = getDailyGame;

  const loginShell = document.getElementById('loginShell');
  const homePage = document.getElementById('homePage');
  const loginUsername = document.getElementById('loginUsername');
  const loginPassword = document.getElementById('loginPassword');
  const loginMsg = document.getElementById('loginMsg');
  const userDisplay = document.getElementById('userDisplay');

const users = {
  "111": "111",
};

loginShell.classList.add('fade');
homePage.classList.add('fade');

// Auto-login if device was previously marked trusted
if (localStorage.getItem('kuppyTrusted') === 'true') {
  const autoUser = localStorage.getItem('kuppyAutoUser') || 'Kuppy';
  try {
    // mimic successful login flow
    loginShell.classList.add('hidden');
    setTimeout(() => {
      loginShell.style.display = 'none';
      document.getElementById('infoShell').style.display = 'flex';
      homePage.style.display = 'block';
      setTimeout(() => {
        homePage.classList.remove('hidden');
        startTyping();
      }, 10);
      userDisplay.textContent = autoUser;
      displayStarredGames();
    }, 500);
  } catch (e) {
    console.warn('Auto-login init failed:', e);
  }
}

userDisplay.addEventListener('click', () => {
  const confirmSignOut = confirm("Are you sure you want to log out?");
  if (!confirmSignOut) return;

  homePage.classList.add('hidden');
  const infoShell = document.getElementById('infoShell');
  if (infoShell) infoShell.style.display = 'none';

  const tempEl = document.getElementById('temperature');
  const descEl = document.getElementById('weatherDesc');
  const feelsEl = document.getElementById('feelsLike');
  const humEl = document.getElementById('humidity');
  const windEl = document.getElementById('windSpeed');
  const iconEl = document.getElementById('weatherIcon');
  if (tempEl) tempEl.textContent = '--¬∞F';
  if (descEl) descEl.textContent = '';
  if (feelsEl) feelsEl.textContent = '--¬∞F';
  if (humEl) humEl.textContent = '--%';
  if (windEl) windEl.textContent = '-- mph';
  if (iconEl) {
    iconEl.textContent = '';
    iconEl.classList.remove('rainy', 'sunny');
  }
  document.body.classList.remove('weather-rain', 'weather-snow', 'weather-sunny');

  setTimeout(() => {
    homePage.style.display = 'none';
    loginShell.style.display = 'flex';
    setTimeout(() => loginShell.classList.remove('hidden'), 10);
    loginUsername.value = '';
    loginPassword.value = '';
  }, 500);
});

let inactivityTimer;

function kickUser() {
  alert("You have been inactive for 30 minutes. You will be signed out.");
  window.location.href = "about:blank";
}

function resetInactivityTimer() {
  clearTimeout(inactivityTimer);
  inactivityTimer = setTimeout(kickUser, 30 * 60 * 1000);
}

["mousemove", "keydown", "click", "scroll", "touchstart"].forEach(evt => {
  document.addEventListener(evt, resetInactivityTimer, false);
});

resetInactivityTimer();

function getWeeklyPassword() {
  const date = new Date();

  const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
  const days = Math.floor((date - firstDayOfYear) / (24 * 60 * 60 * 1000));
  const week = Math.ceil((days + firstDayOfYear.getDay() + 1) / 7);

  const seed = date.getFullYear() + "-W" + week;

  let hash = 0;
  for (let i = 0; i < seed.length; i++) {
    hash = (hash * 32 + seed.charCodeAt(i)) % 999999;
  }

  return "Kuppy" + hash.toString(16).toUpperCase();
}

const secretCode = "KupCloakPass";
const weeklyPassword = getWeeklyPassword();
document.getElementById("passwordUnlock").addEventListener("click", () => {
  const entered = prompt("Enter special code:");
  if (entered === secretCode) {
    alert(`‚úÖ Your weekly password is:\n\n${weeklyPassword}`);
  } else if (entered === "050124") {
    // Enable a trusted device mode: user will be auto-logged in on this browser
    localStorage.setItem('kuppyTrusted', 'true');
    localStorage.setItem('kuppyAutoUser', 'Kuppy');
    alert('‚úÖ Trusted device enabled. You will be logged in automatically on this device.');

    // Immediately perform the same UI transitions as a successful login
    try {
      loginShell.classList.add('hidden');
      setTimeout(() => {
        loginShell.style.display = 'none';
        document.getElementById('infoShell').style.display = 'flex';
        homePage.style.display = 'block';
        setTimeout(() => {
          homePage.classList.remove('hidden');
          startTyping();
        }, 10);
        userDisplay.textContent = 'Kuppy';
        displayStarredGames();
      }, 500);
    } catch (e) {
      // safety: if elements aren't available, ignore
      console.warn('Auto-login failed:', e);
    }
  } else if (entered !== null) {
    alert("‚ùå Wrong code.");
  }
});

const passwordInput = document.getElementById('loginPassword');
const togglePassword = document.getElementById('togglePassword');

togglePassword.addEventListener('click', () => {
  const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
  passwordInput.setAttribute('type', type);
  togglePassword.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
});

const bgButton = document.getElementById('bgButton');
const bgUpload = document.getElementById('bgUpload');

bgButton.addEventListener('click', () => bgUpload.click());

bgUpload.addEventListener('change', (event) => {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    const dataURL = e.target.result;
    localStorage.setItem('customBackground', dataURL);
    document.body.style.backgroundImage = `url(${dataURL})`;
  };
  reader.readAsDataURL(file);
});

window.addEventListener('load', () => {
  const savedBG = localStorage.getItem('customBackground');
  if (savedBG) {
    document.body.style.backgroundImage = `url(${savedBG})`;
    document.body.style.backgroundSize = 'cover';
    document.body.style.backgroundPosition = 'center';
  }
});

function updateTime() {
  const now = new Date();
  let hours = now.getHours();
  const minutes = now.getMinutes();
  const ampm = hours >= 12 ? 'PM' : 'AM';
  hours = hours % 12 || 12;
  const timeStr = `${hours}:${minutes.toString().padStart(2, '0')} ${ampm}`;
  
  const options = { weekday: 'long', month: 'short', day: 'numeric', year: 'numeric' };
  const dateStr = now.toLocaleDateString('en-US', options);
  
  document.getElementById('timeDisplay').textContent = timeStr;
  document.getElementById('dateDisplay').textContent = dateStr;
}

updateTime();
setInterval(updateTime, 1000);

async function fetchWeather() {
  try {
    const response = await fetch('https://wttr.in/Bridgewater,NJ?format=j1');
    
    if (!response.ok) {
      throw new Error('Weather data unavailable');
    }
    
    const data = await response.json();
    const current = data.current_condition[0];
    
    const temp = Math.round(parseFloat(current.temp_F));
    const feelsLike = Math.round(parseFloat(current.FeelsLikeF));
    const humidity = current.humidity;
    const windSpeed = Math.round(parseFloat(current.windspeedMiles));
    const desc = current.weatherDesc[0].value.toLowerCase();
    
    document.getElementById('temperature').textContent = `${temp}¬∞F`;
    document.getElementById('weatherDesc').textContent = desc;
    document.getElementById('feelsLike').textContent = `${feelsLike}¬∞F`;
    document.getElementById('humidity').textContent = `${humidity}%`;
    document.getElementById('windSpeed').textContent = `${windSpeed} mph`;
    
    const weatherIcons = {
      'clear': '‚òÄÔ∏è',
      'sunny': '‚òÄÔ∏è',
      'partly cloudy': '‚õÖ',
      'cloudy': '‚òÅÔ∏è',
      'overcast': '‚òÅÔ∏è',
      'mist': 'üå´Ô∏è',
      'fog': 'üå´Ô∏è',
      'light rain': 'üå¶Ô∏è',
      'rain': 'üåßÔ∏è',
      'heavy rain': 'üåßÔ∏è',
      'thunderstorm': '‚õàÔ∏è',
      'snow': '‚ùÑÔ∏è',
      'light snow': 'üå®Ô∏è'
    };
    
    let icon = 'üå§Ô∏è';
    for (const [key, value] of Object.entries(weatherIcons)) {
      if (desc.includes(key)) {
        icon = value;
        break;
      }
    }
    document.getElementById('weatherIcon').textContent = icon;
    
  } catch (error) {
    console.error('Weather fetch error:', error);
    document.getElementById('weatherDesc').textContent = 'Weather unavailable';
    document.getElementById('temperature').textContent = '--¬∞F';
  }
}

fetchWeather();
setInterval(fetchWeather, 600000);

document.addEventListener('mousemove', (e) => {
  const cards = document.querySelectorAll('.card');
  
  cards.forEach(card => {
    const rect = card.getBoundingClientRect();
    const cardCenterX = rect.left + rect.width / 2;
    const cardCenterY = rect.top + rect.height / 2;
    
    const distanceX = e.clientX - cardCenterX;
    const distanceY = e.clientY - cardCenterY;
    const distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY);
    
    if (distance < 200) {
      const angleX = (distanceY / rect.height) * 15;
      const angleY = (distanceX / rect.width) * -15;
      
      card.style.transform = `perspective(1000px) rotateX(${angleX}deg) rotateY(${angleY}deg) translateY(-8px) scale(1.05)`;
    } else {
      card.style.transform = '';
    }
  });
});

function showToast(message, type = 'success') {
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  
  const icon = type === 'success' ? '‚úì' : '‚úó';
  toast.innerHTML = `<span style="font-size:20px;">${icon}</span><span>${message}</span>`;
  
  document.body.appendChild(toast);
  
  setTimeout(() => {
    toast.style.animation = 'toastSlideIn 0.3s reverse';
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

const originalFetchWeather = fetchWeather;
fetchWeather = async function() {
  await originalFetchWeather();
  
  const desc = document.getElementById('weatherDesc').textContent.toLowerCase();
  const weatherIcon = document.getElementById('weatherIcon');
  
  document.body.classList.remove('weather-rain', 'weather-snow', 'weather-sunny');
  
  if (desc.includes('rain') || desc.includes('drizzle')) {
    document.body.classList.add('weather-rain');
    weatherIcon.classList.add('rainy');
  } else if (desc.includes('snow')) {
    document.body.classList.add('weather-snow');
  } else if (desc.includes('clear') || desc.includes('sunny')) {
    document.body.classList.add('weather-sunny');
    weatherIcon.classList.add('sunny');
  }
};

const parallaxElements = document.querySelectorAll('.shell, .info-shell');
window.addEventListener('scroll', () => {
  const scrolled = window.pageYOffset;
  
  parallaxElements.forEach((el, index) => {
    const speed = 0.05 * (index + 1);
    el.style.transform = `translateY(${scrolled * speed}px)`;
  });
});

fetchWeather();

const originalCreateGameCard = createGameCard;
createGameCard = function(g, idx, savedArray, starredArray, categoryLength, reloadFn) {
  const card = originalCreateGameCard(g, idx, savedArray, starredArray, categoryLength, reloadFn);
  
  const starBtn = card.querySelector('.starBtn');
  if (starBtn) {
    const originalOnClick = starBtn.onclick;
    starBtn.onclick = (e) => {
      e.stopPropagation();
      
      const wasStarred = starBtn.classList.contains('starred');
      originalOnClick(e);
      
      if (!wasStarred) {
        showToast(`‚≠ê ${g.name} added to favorites!`, 'success');
      } else {
        showToast(`${g.name} removed from favorites`, 'success');
      }
    };
  }
  
  return card;
};

function createRipple(event, element) {
  const ripple = document.createElement('span');
  const rect = element.getBoundingClientRect();
  const size = Math.max(rect.width, rect.height);
  const x = event.clientX - rect.left - size / 2;
  const y = event.clientY - rect.top - size / 2;
  
  ripple.style.cssText = `
    position: absolute;
    width: ${size}px;
    height: ${size}px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    top: ${y}px;
    left: ${x}px;
    pointer-events: none;
    animation: rippleEffect 0.6s ease-out;
    z-index: 1;
  `;
  
  const style = document.createElement('style');
  if (!document.getElementById('rippleStyle')) {
    style.id = 'rippleStyle';
    style.textContent = `
      @keyframes rippleEffect {
        from {
          transform: scale(0);
          opacity: 1;
        }
        to {
          transform: scale(2);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);
  }
  
  element.appendChild(ripple);
  setTimeout(() => ripple.remove(), 600);
}

document.addEventListener('click', (e) => {
  const card = e.target.closest('.card');
  if (card && !e.target.closest('.starBtn') && !e.target.closest('.deleteBtn')) {
    createRipple(e, card);
  }
});

document.querySelectorAll('.btn').forEach(btn => {
  btn.addEventListener('mouseenter', function() {
    this.style.transform = 'translateY(-2px) scale(1.02)';
  });
  
  btn.addEventListener('mouseleave', function() {
    this.style.transform = '';
  });
  
  btn.addEventListener('mousedown', function() {
    this.style.transform = 'scale(0.92)';
  });
  
  btn.addEventListener('mouseup', function() {
    this.style.transform = 'translateY(-2px) scale(1.02)';
  });
});

function showSkeletonLoaders(gridElement, count = 10) {
  gridElement.innerHTML = '';
  
  for (let i = 0; i < count; i++) {
    const skeleton = document.createElement('div');
    skeleton.className = 'card skeleton';
    skeleton.style.width = '135px';
    skeleton.style.height = '135px';
    skeleton.style.animationDelay = `${i * 0.1}s`;
    gridElement.appendChild(skeleton);
  }
}

const originalLoadGamesPage = loadGamesPage;
loadGamesPage = function() {
  const grid = document.getElementById('allGamesGrid');
  showSkeletonLoaders(grid, 20);
  
  setTimeout(() => {
    originalLoadGamesPage();
  }, 300);
};

const originalLoadMultiGamesPage = loadmultiGamesPage;
loadmultiGamesPage = function() {
  const grid = document.getElementById('multiGamesGrid');
  showSkeletonLoaders(grid, 8);
  
  setTimeout(() => {
    originalLoadMultiGamesPage();
  }, 300);
};

const originalLoadPuzzleGamesPage = loadpuzzleGamesPage;
loadpuzzleGamesPage = function() {
  const grid = document.getElementById('puzzleGamesGrid');
  showSkeletonLoaders(grid, 8);
  
  setTimeout(() => {
    originalLoadPuzzleGamesPage();
  }, 300);
};

const originalLoadObbyGamesPage = loadobbyGamesPage;
loadobbyGamesPage = function() {
  const grid = document.getElementById('obbyGamesGrid');
  showSkeletonLoaders(grid, 5);
  
  setTimeout(() => {
    originalLoadObbyGamesPage();
  }, 300);
};

const originalLoadSportsGamesPage = loadsportsGamesPage;
loadsportsGamesPage = function() {
  const grid = document.getElementById('sportsGamesGrid');
  showSkeletonLoaders(grid, 7);
  
  setTimeout(() => {
    originalLoadSportsGamesPage();
  }, 300);
};

document.addEventListener('mousemove', (e) => {
  const cards = document.querySelectorAll('.card:not(.skeleton)');
  
  cards.forEach(card => {
    const rect = card.getBoundingClientRect();
    const cardCenterX = rect.left + rect.width / 2;
    const cardCenterY = rect.top + rect.height / 2;
    
    const distanceX = e.clientX - cardCenterX;
    const distanceY = e.clientY - cardCenterY;
    const distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY);
    
    if (distance < 150 && distance > 0) {
      const pullStrength = (150 - distance) / 150;
      const pullX = (distanceX / distance) * pullStrength * 8;
      const pullY = (distanceY / distance) * pullStrength * 8;
      
      const currentTransform = card.style.transform || '';
      if (!currentTransform.includes('perspective')) {
        card.style.transform = `translate(${pullX}px, ${pullY}px)`;
      }
    }
  });
});

const originalShowGamesPage = showGamesPage;
showGamesPage = function() {
  const home = document.getElementById('homePage');
  const games = document.getElementById('gamesPage');
  
  home.style.transform = 'translateX(-100%)';
  home.style.opacity = '0';
  
  setTimeout(() => {
    home.style.display = 'none';
    home.style.transform = '';
    document.getElementById('infoShell').style.display = 'none';
    games.style.display = 'flex';
    games.classList.add('show');
    loadGamesPage();
  }, 500);
};

const originalShowHomePage = showHomePage;
showHomePage = function() {
  const home = document.getElementById('homePage');
  const pages = [
    document.getElementById('gamesPage'),
    document.getElementById('multigamesPage'),
    document.getElementById('puzzlegamesPage'),
    document.getElementById('obbygamesPage'),
    document.getElementById('sportsgamesPage')
  ];
  
  pages.forEach(page => {
    page.style.transform = 'translateX(100%)';
    page.style.opacity = '0';
    page.classList.remove('show');
  });
  
  setTimeout(() => {
    pages.forEach(page => {
      page.style.display = 'none';
      page.style.transform = '';
    });
    
    document.getElementById('infoShell').style.display = 'flex';
    home.style.display = 'block';
    home.style.transform = 'translateX(-100%)';
    home.style.opacity = '0';
    
    requestAnimationFrame(() => {
      home.style.transition = 'transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.5s';
      home.style.transform = 'translateX(0)';
      home.style.opacity = '1';
      displayStarredGames();
    });
  }, 500);
};

const categoryTransitions = [
  { show: showMultiGamesPage, page: 'multigamesPage' },
  { show: showPuzzleGamesPage, page: 'puzzlegamesPage' },
  { show: showObbyGamesPage, page: 'obbygamesPage' },
  { show: showSportsGamesPage, page: 'sportsgamesPage' }
];

categoryTransitions.forEach(({ show, page }) => {
  const originalShow = window[show.name];
  window[show.name] = function() {
    const home = document.getElementById('homePage');
    const targetPage = document.getElementById(page);
    
    home.style.transform = 'translateX(-100%)';
    home.style.opacity = '0';
    
    setTimeout(() => {
      home.style.display = 'none';
      home.style.transform = '';
      document.getElementById('infoShell').style.display = 'none';
      targetPage.style.display = 'flex';
      targetPage.classList.add('show');
      
      const loadFnName = 'load' + page.replace('Page', 'Page').replace('games', 'Games');
      if (window[loadFnName]) window[loadFnName]();
    }, 500);
  };
});

const originalRandomBtn = document.getElementById('randomGameBtn').onclick;
document.getElementById('randomGameBtn').onclick = function() {
  showToast('üé≤ Selecting random game...', 'success');
  setTimeout(() => {
    originalRandomBtn();
  }, 300);
};

const observer = new MutationObserver((mutations) => {
  mutations.forEach((mutation) => {
    mutation.addedNodes.forEach((node) => {
      if (node.classList && node.classList.contains('card') && !node.classList.contains('skeleton')) {
        const cards = Array.from(node.parentElement.children);
        const index = cards.indexOf(node);
        node.style.animation = `fadeInScale 0.4s ease-out ${index * 0.05}s both`;
      }
    });
  });
});

['allGamesGrid', 'multiGamesGrid', 'puzzleGamesGrid', 'obbyGamesGrid', 'sportsGamesGrid'].forEach(id => {
  const grid = document.getElementById(id);
  if (grid) {
    observer.observe(grid, { childList: true });
  }
});

const KuppyState = {
  soundEnabled: localStorage.getItem('kuppySoundEnabled') !== 'false',
  stats: JSON.parse(localStorage.getItem('kuppyStats') || '{"launches":0,"favorites":0,"playtime":0,"games":{}}'),
  badges: JSON.parse(localStorage.getItem('kuppyBadges') || '[]'),
  combo: 0,
  comboTimer: null,
  customCursor: localStorage.getItem('kuppyCustomCursor') === 'true',
};

function createConfetti(x, y, count = 50) {
  const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffa500', '#ff69b4'];
  
  for (let i = 0; i < count; i++) {
    const confetti = document.createElement('div');
    confetti.className = 'confetti';
    confetti.style.left = x + 'px';
    confetti.style.top = y + 'px';
    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
    confetti.style.animationDuration = (Math.random() * 2 + 1) + 's';
    confetti.style.animationDelay = (Math.random() * 0.5) + 's';
    
    const angle = (Math.random() * 360) * Math.PI / 180;
    const velocity = Math.random() * 200 + 100;
    confetti.style.setProperty('--tx', Math.cos(angle) * velocity + 'px');
    confetti.style.setProperty('--ty', Math.sin(angle) * velocity + 'px');
    
    document.body.appendChild(confetti);
    
    setTimeout(() => confetti.remove(), 3000);
  }
  
}

const achievements = [
  { id: 'first_launch', name: 'First Steps', desc: 'Launch your first game', icon: 'üéÆ', check: () => KuppyState.stats.launches >= 1 },
  { id: 'game_hoarder', name: 'Game Hoarder', desc: 'Star 5 games', icon: '‚≠ê', check: () => KuppyState.stats.favorites >= 5 },
  { id: 'dedicated', name: 'Dedicated Player', desc: 'Launch 25 games', icon: 'üèÜ', check: () => KuppyState.stats.launches >= 25 },
  { id: 'speed_runner', name: 'Speed Runner', desc: 'Build a 5x combo', icon: '‚ö°', check: () => false },
  { id: 'night_owl', name: 'Night Owl', desc: 'Use KuppyCloaker after midnight', icon: 'ü¶â', check: () => new Date().getHours() >= 0 && new Date().getHours() < 6 },
  { id: 'collector', name: 'Collector', desc: 'Star 10 games', icon: 'üíé', check: () => KuppyState.stats.favorites >= 10 },
  { id: 'explorer', name: 'Explorer', desc: 'Try the random game 10 times', icon: 'üß≠', check: () => (KuppyState.stats.games['__random__'] || 0) >= 10 },
  { id: 'marathon', name: 'Marathon Runner', desc: 'Launch 50 games', icon: 'üèÉ', check: () => KuppyState.stats.launches >= 50 },
  { id: 'master', name: 'Kuppy Master', desc: 'Earn all other badges', icon: 'üëë', check: () => KuppyState.badges.length >= 9 }
];

function checkAchievements() {
  achievements.forEach(achievement => {
    if (!KuppyState.badges.includes(achievement.id) && achievement.check()) {
      unlockAchievement(achievement);
    }
  });
  
  saveStats();
}

function unlockAchievement(achievement) {
  KuppyState.badges.push(achievement.id);
  localStorage.setItem('kuppyBadges', JSON.stringify(KuppyState.badges));
  
  const achDiv = document.createElement('div');
  achDiv.className = 'achievement';
  achDiv.innerHTML = `
    <div class="achievement-icon">${achievement.icon}</div>
    <div class="achievement-content">
      <h3>Achievement Unlocked!</h3>
      <p><strong>${achievement.name}</strong> - ${achievement.desc}</p>
    </div>
  `;
  
  document.body.appendChild(achDiv);
  
  createConfetti(window.innerWidth - 200, 100, 30);
  screenShake();
  
  setTimeout(() => achDiv.remove(), 4000);
  
  updateBadgeDisplay();
  checkAchievements();
}

function updateBadgeDisplay() {
  const badgeDisplay = document.getElementById('badgeDisplay');
  if (!badgeDisplay) return;

  badgeDisplay.innerHTML = '';
  
  achievements.forEach(ach => {
    const unlocked = KuppyState.badges.includes(ach.id);

    const badge = document.createElement('div');
    badge.className = 'badge' + (unlocked ? '' : ' locked');
    badge.innerHTML = ach.icon;
    badge.title = unlocked
      ? `${ach.name} ‚Äì ${ach.desc}`
      : `Locked ‚Äì ${ach.desc}`;

    badge.style.cursor = unlocked ? "help" : "not-allowed";

    badgeDisplay.appendChild(badge);
  });
}


function incrementCombo() {
  KuppyState.combo++;
  
  clearTimeout(KuppyState.comboTimer);
  KuppyState.comboTimer = setTimeout(() => {
    KuppyState.combo = 0;
  }, 2000);
  
  if (KuppyState.combo >= 2) {
    const comboDiv = document.getElementById('comboCounter');
    comboDiv.textContent = `x${KuppyState.combo} COMBO!`;
    comboDiv.classList.remove('show');
    void comboDiv.offsetWidth;
    comboDiv.classList.add('show');
    
    setTimeout(() => {
      comboDiv.classList.remove('show');
    }, 1000);
  }
  
  if (KuppyState.combo >= 5 && !KuppyState.badges.includes('speed_runner')) {
    unlockAchievement(achievements.find(a => a.id === 'speed_runner'));
  }
}

function screenShake() {
  document.body.classList.add('shake');
  setTimeout(() => {
    document.body.classList.remove('shake');
  }, 500);
}

function trackGameLaunch(gameName) {
  KuppyState.stats.launches++;
if (gameName !== 'Unknown Game') {
  KuppyState.stats.games[gameName] =
    (KuppyState.stats.games[gameName] || 0) + 1;
}

  
  incrementCombo();
  saveStats();
  checkAchievements();
}

function saveStats() {
  localStorage.setItem('kuppyStats', JSON.stringify(KuppyState.stats));
}

function updateStatsDisplay() {
  document.getElementById('statLaunches').textContent = KuppyState.stats.launches;
  document.getElementById('statFavorites').textContent = JSON.parse(localStorage.getItem('starredGames') || '[]').length;
const totalMinutes = Math.floor(KuppyState.stats.playtime / 60);
const hours = Math.floor(totalMinutes / 60);
const minutes = totalMinutes % 60;
document.getElementById('statPlaytime').textContent = hours > 0 ? `${hours}h ${minutes}m` : `${minutes}m`;  
  const mostPlayed = Object.entries(KuppyState.stats.games)
    .filter(([name]) => name !== '__random__')
    .sort(([,a], [,b]) => b - a)[0];
  
  document.getElementById('statMostPlayed').textContent = mostPlayed ? `${mostPlayed[0]} (${mostPlayed[1]}x)` : 'None';
  document.getElementById('statBadges').textContent = `${KuppyState.badges.length}/${achievements.length}`;
  
  updateBadgeDisplay();
}
  
const fab = document.getElementById('fab');
const fabMenu = document.getElementById('fabMenu');
let fabOpen = false;

fab.onclick = () => {
  fabOpen = !fabOpen;
  fabMenu.classList.toggle('show');
  fab.style.transform = fabOpen ? 'rotate(135deg)' : '';
};

document.getElementById('fabStats').onclick = () => {
  document.getElementById('statsPanel').classList.add('show');
  updateStatsDisplay();
  fabMenu.classList.remove('show');
  fabOpen = false;
  fab.style.transform = '';
};

document.getElementById('statsClose').onclick = () => {
  document.getElementById('statsPanel').classList.remove('show');
};

const originalOpenWebsite = openWebsite;
openWebsite = function(url) {
  let gameName = 'Unknown Game';

  const normalizedUrl = url.replace(/^https?:\/\//, '');

  const saved = JSON.parse(localStorage.getItem('customPresets') || '[]');
  const allGames = [...defaultGames, ...saved];

  const found = allGames.find(g =>
    g.url.replace(/^https?:\/\//, '').includes(normalizedUrl)
  );

  if (found) {
    gameName = found.name;
  } else {
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
      const title = card.querySelector('.card-title')?.textContent || '';
      const onclickStr = card.onclick?.toString() || '';
      if (onclickStr.includes(url) || onclickStr.includes(normalizedUrl)) {
        gameName = title;
      }
    });
  }

  if (gameName !== 'Unknown Game') {
    trackGameLaunch(gameName);
    showToast(`üöÄ Launching ${gameName}...`, 'success');
  }

  originalOpenWebsite(url);
};

document.getElementById('randomGameBtn').addEventListener('click', function(e) {
  e.stopPropagation();
  
  const cards = Array.from(document.querySelectorAll('.card:not(.skeleton)'));
  if (cards.length === 0) return;
  
  let spins = 0;
  const maxSpins = 20;
  
  const spinInterval = setInterval(() => {
    cards.forEach(card => card.classList.remove('flipping'));
    
    const randomCard = cards[Math.floor(Math.random() * cards.length)];
    randomCard.classList.add('flipping');
    
    spins++;
    
    if (spins >= maxSpins) {
      clearInterval(spinInterval);
      
      setTimeout(() => {
        randomCard.click();
        trackGameLaunch('__random__');
      }, 300);
    }
  }, 100);
  
});

const originalStarClick = document.querySelector('.starBtn')?.onclick;

document.addEventListener('click', (e) => {
  if (e.target.classList.contains('starBtn')) {
    const rect = e.target.getBoundingClientRect();
    createConfetti(rect.left + rect.width / 2, rect.top + rect.height / 2, 20);
    
    KuppyState.stats.favorites = JSON.parse(localStorage.getItem('starredGames') || '[]').length;
    saveStats();
    checkAchievements();
  }
});

document.querySelectorAll('.btn, .gear, #fab').forEach(el => {
  el.classList.add('breathe');
});

window.addEventListener('load', () => {
  const welcomeOverlay = document.getElementById('welcomeOverlay');
  const welcomeProgress = document.getElementById('welcomeProgress');
  
  let progress = 0;
  const progressInterval = setInterval(() => {
    progress += Math.random() * 15 + 5;
    if (progress >= 100) progress = 100;
    
    welcomeProgress.style.width = progress + '%';
    
    if (progress >= 100) {
      clearInterval(progressInterval);
      
      setTimeout(() => {
        welcomeOverlay.classList.add('hide');
        
        setTimeout(() => {
          welcomeOverlay.remove();
        }, 1000);
      }, 500);
    }
  }, 150);
  
  checkAchievements();
});

const originalShowToast = showToast;
showToast = function(message, type = 'success') {
  originalShowToast(message, type);
  
  if (type === 'success') {
  } else if (type === 'error') {
  }
};

setInterval(() => {
  KuppyState.stats.playtime += 1;
  saveStats();
}, 1000);

document.querySelectorAll('.btn, button').forEach(btn => {
  btn.addEventListener('click', () => {
    if (!btn.id?.includes('sound') && !btn.id?.includes('stats')) {
    }
  });
});

document.addEventListener('click', (e) => {
  if (e.target.closest('.card') && !e.target.closest('.starBtn') && !e.target.closest('.deleteBtn')) {
  }
});

document.getElementById('gear').addEventListener('click', () => {
});

document.getElementById('allGamesBtn').addEventListener('click', () => {
  showToast('üìö Opening all games...', 'success');
});

document.getElementById('multiGamesBtn').addEventListener('click', () => {
  showToast('üßë‚Äçü§ù‚Äçüßë Loading multiplayer games...', 'success');
});

document.getElementById('puzzleGamesBtn').addEventListener('click', () => {
  showToast('üß© Brain teasers loading...', 'success');
});

document.getElementById('obbyGamesBtn').addEventListener('click', () => {
  showToast('üèÉ Parkour time!', 'success');
});

document.getElementById('sportsGamesBtn').addEventListener('click', () => {
  showToast('‚öΩ Sports games loading...', 'success');
});

document.getElementById('dailyGameBtn').addEventListener('click', () => {
  showToast('üìÖ Loading today\'s featured game...', 'success');
});

document.getElementById('recentGamesBtn').addEventListener('click', () => {
  const recent = JSON.parse(localStorage.getItem('recentGame'));
  if (recent) {
    showToast(`üïì Reopening ${recent.name}...`, 'success');
  }
});

[document.getElementById('backBtn'), 
 document.getElementById('multiBackBtn'),
 document.getElementById('puzzleBackBtn'),
 document.getElementById('obbyBackBtn'),
 document.getElementById('sportsBackBtn')].forEach(btn => {
  btn?.addEventListener('click', () => {
    showToast('üè† Returning home...', 'success');
  });
});

document.getElementById('lightToggle').addEventListener('click', () => {
  const isLight = document.body.classList.contains('light');
  showToast(isLight ? 'üåô Dark mode activated' : '‚òÄÔ∏è Light mode activated', 'success');
});

document.getElementById('colorToggle').addEventListener('click', () => {
  showToast('üé® Theme changed!', 'success');
});

let clickCount = 0;
let clickTimer = null;

document.getElementById('typedTitle').addEventListener('click', () => {
  clickCount++;
  
  clearTimeout(clickTimer);
  clickTimer = setTimeout(() => {
    clickCount = 0;
  }, 500);
  
  if (clickCount === 3) {
    const easterEgg = document.createElement('div');
    easterEgg.className = 'easter-egg-found';
    easterEgg.textContent = 'üéâ';
    document.body.appendChild(easterEgg);
    
    createConfetti(window.innerWidth / 2, 100, 50);    
    setTimeout(() => easterEgg.remove(), 2000);
    
    showToast('üéâ You found the secret! Here\'s a surprise!', 'success');
    
    const saved = JSON.parse(localStorage.getItem('customPresets') || '[]');
    const allGames = [...defaultGames, ...saved];
    const randomGame = allGames[Math.floor(Math.random() * allGames.length)];
    
    let starred = JSON.parse(localStorage.getItem('starredGames') || '[]');
    if (!starred.includes(randomGame.name)) {
      starred.push(randomGame.name);
      localStorage.setItem('starredGames', JSON.stringify(starred));
      showToast(`‚≠ê ${randomGame.name} has been auto-starred!`, 'success');
      displayStarredGames();
    }
    
    clickCount = 0;
  }
});

updateBadgeDisplay();
checkAchievements();

const cardObserver = new MutationObserver(() => {
  document.querySelectorAll('.card:not(.breathe-checked)').forEach(card => {
    card.classList.add('breathe-checked');
    
    card.addEventListener('mouseenter', () => {
      if (KuppyState.soundEnabled) {
        playSound(300, 0.05, 'sine');
      }
    });
  });
});

['allGamesGrid', 'multiGamesGrid', 'puzzleGamesGrid', 'obbyGamesGrid', 'sportsGamesGrid'].forEach(id => {
  const grid = document.getElementById(id);
  if (grid) {
    cardObserver.observe(grid, { childList: true, subtree: true });
  }
});

const specialMessages = [
  { hour: 0, message: 'üåô Burning the midnight oil? Night Owl achievement unlocked!' },
  { hour: 6, message: 'üåÖ Good morning, early bird!' },
  { hour: 12, message: '‚òÄÔ∏è Good afternoon! Time for a game break?' },
  { hour: 18, message: 'üåÜ Good evening! Ready to unwind?' },
  { hour: 22, message: 'üåÉ Late night gaming session?' }
];

const currentHour = new Date().getHours();
const specialMessage = specialMessages.find(m => m.hour === currentHour);

if (specialMessage) {
  setTimeout(() => {
    showToast(specialMessage.message, 'success');
  }, 2000);
}

const motivationalQuotes = [
  'Every game is a new adventure! üéÆ',
  'You\'ve launched ' + KuppyState.stats.launches + ' games so far! üöÄ',
  'Keep exploring and having fun! ‚ú®',
  'Gaming is not just a hobby, it\'s a lifestyle! üéØ',
  'You\'re doing great! üåü'
];

setInterval(() => {
  const quote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
  showToast(quote, 'success');
}, 60000);

if (KuppyState.stats.launches > 0 && KuppyState.stats.launches % 10 === 0) {
  setTimeout(() => {
    createConfetti(window.innerWidth / 2, window.innerHeight / 2, 30);
    showToast(`üéâ Milestone! You've launched ${KuppyState.stats.launches} games!`, 'success');
  }, 3000);
}

</script>
</body>
</html>
