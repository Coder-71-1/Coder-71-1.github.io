<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>lolCloaker</title>
<style>
:root {
  --bg: #1c0d0d; /* New Red/Orange Theme Background */
  --card: #2e1a1a; /* New Red/Orange Theme Card */
  --muted: #93a3b8;
  --accent: #ff4500; /* New Red/Orange Accent Color */
  --text: #e6eef8;
}
* {
  transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;
}

/* All home page elements (except login) are now removed/hidden by default */
#homePage {
  display: none;
}
#infoShell {
  display: none; /* Removed time/date display */
}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  min-height: 100%;
  overflow: hidden;
}

body {
  font-family: Inter, system-ui, sans-serif;
  background-color: var(--bg);
  color: var(--text);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  padding: 20px;
  gap: 16px;
  transition: background-color 0.5s, color 0.5s, opacity 2s ease;
  opacity: 0;
  overflow-y: auto;
  position: relative;
  /* Removed 'loaded' class here to only apply after full load/login */
}
body.loaded { opacity: 1; }

#particleCanvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
  opacity: 0.6;
}

body::before {
  content: '';
  position: fixed;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle at 20% 50%, rgba(255, 69, 0, 0.03) 0%, transparent 50%),
              radial-gradient(circle at 80% 80%, rgba(147, 51, 234, 0.03) 0%, transparent 50%),
              radial-gradient(circle at 40% 20%, rgba(255, 69, 0, 0.02) 0%, transparent 50%);
  animation: ambientMove 20s ease-in-out infinite;
  z-index: 0;
  pointer-events: none;
}

@keyframes ambientMove {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  33% { transform: translate(3%, 3%) rotate(2deg); }
  66% { transform: translate(-2%, 4%) rotate(-1deg); }
}

.shell {
  background: var(--card);
  border-radius: 14px;
  padding: 22px 30px;
  box-shadow: 0 10px 30px rgba(2,6,23,0.6);
  position: relative;
  width: 100%;
  max-width: 800px;
  animation: fadeInScale 0.6s ease-out;
  z-index: 1;
}
/* Removed header, topbar, tab-buttons, and footer CSS from the login screen context */

@keyframes fadeInScale {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.btn {
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 10px;
  padding: 10px 16px;
  cursor: pointer;
  font-weight: 600;
  transition: transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s;
  position: relative;
  overflow: hidden;
}

.btn:active {
  transform: scale(0.92);
}

.btn:hover { 
  opacity: 0.9;
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 4px 12px rgba(255, 69, 0, 0.4);
}

/* Game Page Styles (Simplified for context) */
#gamesPage, #multigamesPage, #puzzlegamesPage, #obbygamesPage, #sportsgamesPage {
  display: none;
  flex-direction: column;
  align-items: center;
  opacity: 0;
  transform: translateX(100%);
  transition: opacity 0.5s, transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  overflow-y: auto;
  overflow-x: hidden;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  padding-bottom: 40px;
  z-index: 1;
}

#gamesPage.show, #multigamesPage.show, 
#puzzlegamesPage.show, #obbygamesPage.show, #sportsgamesPage.show {
  display: flex;
  opacity: 1;
  transform: translateX(0);
}

.presets-grid {
  margin-top: 20px;
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
  justify-items: center;
}

.card { /* Simplified card styles */
  background: rgba(255,255,255,0.05);
  border-radius: 8px;
  padding: 8px;
  cursor: pointer;
  width: 135px;
  aspect-ratio: 1 / 1;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  transform-style: preserve-3d;
  perspective: 1000px;
}

/* Login Card Styles */
#loginShell {
  position: fixed;
  inset: 0;
  display: none; /* Controlled by JS */
  justify-content: center; 
  align-items: center; 
  height: 100vh;
  transition: opacity 0.5s ease;
}

.login-card {
  background: var(--card); 
  padding: 30px; 
  border-radius: 16px; 
  box-shadow: 0 0 20px rgba(0,0,0,0.5); 
  width: 320px; 
  text-align: center;
  animation: fadeInScale 0.6s ease-out;
}

.login-card input {
  width: 100%; 
  padding:10px; 
  margin-bottom:5px; 
  border-radius:8px; 
  border:none; 
  outline:none; 
  font-family: Inter, system-ui, sans-serif; 
  box-sizing: border-box;
  background: var(--bg);
  color: var(--text);
}

</style>
</head>
<body>
<canvas id="particleCanvas"></canvas>

<div id="gamesPage">
  <h2>All lol Games</h2>
  <input type="text" id="gameSearchBar" placeholder="Search lol Games..." style="margin-bottom: 20px; width: 80%; padding: 10px; border-radius: 8px; border: 1px solid var(--muted); background: var(--card); color: var(--text); font-size: 16px;">
  <div class="presets-grid" id="allGamesGrid"></div>
</div> 

<div id="multigamesPage"><h2>Multiplayer Games</h2><div class="multiplayer-grid" id="multiGamesGrid"></div></div>
<div id="puzzlegamesPage"><h2>Puzzle Games</h2><div class="puzzle-grid" id="puzzleGamesGrid"></div></div>
<div id="obbygamesPage"><h2>Obby Games</h2><div class="obby-grid" id="obbyGamesGrid"></div></div>
<div id="sportsgamesPage"><h2>Sports Games</h2><div class="sports-grid" id="sportsGamesGrid"></div></div>

<div id="fadeOverlay"></div>

<div class="shell" id="loginShell">
  <div class="login-card">
    <h1 style="color:var(--accent); margin-bottom:5px;">lolCloaker</h1>
    <p id="loginMsg" style="color:red; font-size:12px; height:16px;"></p>
    <div style="width: 80%; margin: 0 auto 10px auto; box-sizing: border-box;">
      <input id="loginUsername" type="text" placeholder="Username" />
    </div>
    <div style="width: 80%; margin: 0 auto 20px auto; position: relative; box-sizing: border-box;">
      <input id="loginPassword" type="password" placeholder="Password" />
      <span id="togglePassword" style="position:absolute; right:10px; top:50%; transform:translateY(-50%); cursor:pointer; user-select:none; color:var(--muted); font-size:16px;">üëÅÔ∏è</span>
    </div>
    <button class="btn" id="loginBtn" style="width: 80%; margin: 0 auto; display: block;">Login</button>
  </div>
</div>

<div class="starred-games-container" id="starredGamesContainer"></div>
<div class="toast" id="toast" style="display: none;"></div>
<div id="fab" style="display: none;">‚öôÔ∏è</div>
<div id="fabMenu" style="display: none;"></div>
<div id="statsPanel" style="display: none;"></div>

<script>
// --- Game Data (Minimal) ---
const defaultGames = [ /* ... game list ... */ ];
// ... other game arrays ...

// --- lolState, LocalStorage, and Stats ---
let lolState = JSON.parse(localStorage.getItem('lolState') || '{"stats": {"launches": 0, "playtime": 0}, "badges": [], "user": "Guest"}');
function saveStats() { localStorage.setItem('lolState', JSON.stringify(lolState)); }
function recordLaunch(gameName) {
  lolState.stats.launches++;
  saveStats();
  // ... other stat logic ...
}

// --- Utility Functions (Minimal) ---
function showToast(message, type = 'default') { /* ... */ }

// --- Theme Logic (Minimal) ---
const defaultThemes = [ 
    { name: 'lol-Red', accent: '#ff4500', bg: '#1c0d0d', card: '#2e1a1a' }, 
    // ... other themes ...
];
let themes = JSON.parse(localStorage.getItem('lolThemes')) || defaultThemes; 
let themeIndex = 0;
// ... theme application logic ...

// --- Game Functions ---
function openWebsite(url) {
  const newTab = window.open('about:blank', '_blank');
  const htmlContent = `
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset='utf-8'>
        <meta name='referrer' content='no-referrer'>
        <title>New Tab</title>
        <style>
          html, body { margin: 0; height: 100%; background: black; }
          embed { width: 100%; height: 100%; border: none; }
          /* No back button or fullscreen controls */
        </style>
      </head>
      <body>
        <embed src='${url}'></embed>
        <script>
          // Remove back button (Escape key) logic
        </script>
      </body>
    </html>
  `;
  newTab.document.write(htmlContent);
  newTab.document.close();
  // ... rememberRecentGame(url);
  recordLaunch(url);
}

// --- Login & Password Logic ---
function getWeeklyPassword() {
  // ... weekly password logic ...
  return "lol" + hash.toString(16).toUpperCase(); // Changed "Kuppy" to "lol"
}

const weeklyPassword = getWeeklyPassword();
const loginShell = document.getElementById('loginShell');
const gamesPage = document.getElementById('gamesPage');
const loginUsername = document.getElementById('loginUsername');
const loginPassword = document.getElementById('loginPassword');
const loginMsg = document.getElementById('loginMsg');
const users = {
  "Parody": "67", // Permanent user
  "111": "111",
};

// No auto-login bypass. The loginShell will be displayed first.

document.getElementById('loginBtn').onclick = () => {
  const user = loginUsername.value.trim();
  const pass = loginPassword.value.trim();

  if (!user || !pass) {
    loginMsg.textContent = "Enter username & password";
    return;
  }
  
  // Permanent sign-in logic
  const isPermanentUser = (user === 'Parody' && pass === '67');
  
  // Special site-wide password (lol2523)
  const isSpecialPassword = (pass === 'lol2523');
  
  // Existing user accounts (111/111) or weekly password
  const isAuthenticated = isPermanentUser || isSpecialPassword || (users[user] === pass) || (pass === weeklyPassword);

  if (isAuthenticated) {
    // Save permanent login for convenience, but the initial check is always required
    localStorage.setItem('lolTrusted', 'true');
    localStorage.setItem('lolAutoUser', user);

    loginShell.style.opacity = '0';
    setTimeout(() => {
      loginShell.style.display = 'none';
      showGamesPage(); // Auto-open All Games page
    }, 500);
  } else {
    loginMsg.textContent = "Incorrect username or password";
  }
};

// --- Page & Game Card Management (Updated to include Search) ---

function filterAndLoadGames(gamesArray, gridId) {
    const grid = document.getElementById(gridId);
    grid.innerHTML = '';
    
    // Get search term
    const searchBar = document.getElementById('gameSearchBar');
    const searchTerm = searchBar ? searchBar.value.toLowerCase() : '';

    const saved = JSON.parse(localStorage.getItem('customPresets') || '[]');
    const starred = JSON.parse(localStorage.getItem('starredGames') || '[]');
    
    // Combine base games and custom games
    let allGames = [];
    if (gridId === 'allGamesGrid') {
        allGames = [...gamesArray, ...saved];
    } else {
        allGames = [...gamesArray]; 
    }

    const filteredGames = allGames.filter(g => g.name.toLowerCase().includes(searchTerm));

    // ... sorting logic ...

    filteredGames.forEach((g, idx) => {
        const card = createGameCard(g, idx, saved, starred, gamesArray.length, () => filterAndLoadGames(gamesArray, gridId));
        grid.appendChild(card);
    });
}

function loadGamesPage(){ filterAndLoadGames(defaultGames, 'allGamesGrid'); }
// ... other load category functions ...

document.getElementById('gameSearchBar').addEventListener('input', () => {
    // Only reload the current visible page
    if (gamesPage.classList.contains('show')) loadGamesPage();
    // ... check other pages ...
});

function showGamesPage(){
  const games=document.getElementById('gamesPage');
  
  // Hide other pages
  // ... (hide all category pages) ...

  games.style.display='flex';
  requestAnimationFrame(()=>{
    games.classList.add('show');
    loadGamesPage();
  });
}
// ... all other functions (createGameCard, displayStarredGames, etc.) must be present ...

// --- Initialization ---
window.onload = () => {
    // No auto-login bypass. Explicitly show the login shell.
    loginShell.style.display = 'flex';
    document.body.classList.add('loaded');
};
</script>
</body>
</html>
